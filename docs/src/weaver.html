
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <title>
            LiTScript - Weaver
        </title>
        <link rel="icon" type="image/icon" href="../images/favicon.svg" />
        <link rel="stylesheet" href="../dist/normal.css" />
        
    </head>
    <body data-syntax-highlight="monokai"
        data-theme="purple-rain">
        
        <div id="navbar">
            
    <div class="navmenu ">
        
    <div class="navitem " >
        <a class="title enabled" href="../index.html" >
            <img src="../images/bulb.svg" />
            <span>LiTScript</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://www.npmjs.com/package/litscript" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-npm" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M1 8h22v7h-12v2h-4v-2h-6z" />
            <path d="M7 8v7" />
            <path d="M14 8v7" />
            <path d="M17 11v4" />
            <path d="M4 11v4" />
            <path d="M11 11v1" />
            <path d="M20 11v4" />
        </svg>
            <span>Download</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="https://github.com/johtela/litscript" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
        </svg>
            <span>GitHub</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a class="enabled" href="../license.html" >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-license" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M15 21h-9a3 3 0 0 1 -3 -3v-1h10v2a2 2 0 0 0 4 0v-14a2 2 0 1 1 2 2h-2m2 -4h-11a3 3 0 0 0 -3 3v11" />
            <path d="M9 7l4 0" />
            <path d="M9 11l4 0" />
        </svg>
            <span>License</span>
        </a>
        
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Syntax Highlight</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="coding-horror">
        <a   onclick="document.body.syntaxHighlight('coding-horror')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Coding Horror</span>
        </a>
        
    </div>
    <div class="navitem active" id="monokai">
        <a   onclick="document.body.syntaxHighlight('monokai')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Monokai</span>
        </a>
        
    </div>
    <div class="navitem " id="solarized-light">
        <a   onclick="document.body.syntaxHighlight('solarized-light')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Solarized Light</span>
        </a>
        
    </div>
    <div class="navitem " id="son-of-obsidian">
        <a   onclick="document.body.syntaxHighlight('son-of-obsidian')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-palette" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" />
            <path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
            <path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" />
        </svg>
            <span>Son of Obsidian</span>
        </a>
        
    </div>
    </div>
    </div>
    <div class="navitem " >
        <a   >
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-caret-down" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 10l6 6l6 -6h-12" />
        </svg>
            <span>Theme</span>
        </a>
        
    <div class="navmenu toggle">
        
    <div class="navitem " id="blueberry">
        <a   onclick="document.body.theme('blueberry')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Blueberry</span>
        </a>
        
    </div>
    <div class="navitem " id="book-cover">
        <a   onclick="document.body.theme('book-cover')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Book Cover</span>
        </a>
        
    </div>
    <div class="navitem " id="brownie">
        <a   onclick="document.body.theme('brownie')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Brownie</span>
        </a>
        
    </div>
    <div class="navitem " id="camouflage">
        <a   onclick="document.body.theme('camouflage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Camouflage</span>
        </a>
        
    </div>
    <div class="navitem " id="chocolate">
        <a   onclick="document.body.theme('chocolate')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Chocolate</span>
        </a>
        
    </div>
    <div class="navitem " id="greyhound">
        <a   onclick="document.body.theme('greyhound')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Greyhound</span>
        </a>
        
    </div>
    <div class="navitem " id="ice-age">
        <a   onclick="document.body.theme('ice-age')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ice Age</span>
        </a>
        
    </div>
    <div class="navitem " id="mustard">
        <a   onclick="document.body.theme('mustard')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Mustard</span>
        </a>
        
    </div>
    <div class="navitem " id="peachy">
        <a   onclick="document.body.theme('peachy')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Peachy</span>
        </a>
        
    </div>
    <div class="navitem " id="red-alert">
        <a   onclick="document.body.theme('red-alert')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Red Alert</span>
        </a>
        
    </div>
    <div class="navitem " id="ultra-violet">
        <a   onclick="document.body.theme('ultra-violet')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Ultra Violet</span>
        </a>
        
    </div>
    <div class="navitem " id="vintage">
        <a   onclick="document.body.theme('vintage')">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-paint" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M5 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v2a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
            <path d="M19 6h1a2 2 0 0 1 2 2a5 5 0 0 1 -5 5l-5 0v2" />
            <path d="M10 15m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" />
        </svg>
            <span>Vintage</span>
        </a>
        
    </div>
    </div>
    </div>
    </div>
            
    <a class="hamburger">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
        </div>
        
        <div class="layout">
            <div class="sidepane narrow-scrollbars">
                
        <div class="tocmenu">
            <h3>Table of Contents</h3>
            
    <ul>
        
    <li>
        <a href="../index.html"><span>üè†</span><span data-toggle="tooltip" data-title="Home page">
            Home
        </span></a>
    </li>
    <li>
        <a href="../introduction.html"><span>ü§ù</span><span data-toggle="tooltip" data-title="Introduction and Motivation">
            Introduction
        </span></a>
    </li>
    <li>
        <a href="../getting-started.html"><span>üèÅ</span>Getting Started</a>
    </li>
    <li>
        <a href="config.html"><span>üéõÔ∏è</span><span data-toggle="tooltip" data-title="Configuration options and command line parsing">
            Configuration
        </span></a>
    </li>
    <li>
        <a href="templates/toc.html"><span>üìñ</span>Table of Contents</a>
    </li>
    <li>
        <a href="templates/front-matter.html"><span>üìã</span>Front Matter</a>
    </li>
    <li>
        <a href="region.html"><span>üåç</span><span data-toggle="tooltip" data-title="Embedding Regions of Code in Markdown">
            Regions
        </span></a>
    </li>
    <li>
        <a href="region-resolver.html"><span>üîó</span><span data-toggle="tooltip" data-title="Dependency resolution and recursive region expansion">
            Region Resolver
        </span></a>
    </li>
    <li>
        <a href="custom-elem.html"><span>üîå</span>Custom Elements</a>
    </li>
    <li>
        <a href="dependency-graph.html"><span>üï∏Ô∏è</span><span data-toggle="tooltip" data-title="Creating module dependency graph">
            Dependency Graph
        </span></a>
    </li>
    <li>
        <a href="bundler.html"><span>üì¶</span><span data-toggle="tooltip" data-title="Packing JS & CSS files">
            Bundler
        </span></a>
    </li>
    <li>
        <a href="server.html"><span>üì°</span><span data-toggle="tooltip" data-title="Development server setup">
            Server
        </span></a>
    </li>
    <li>
        <a href="backend.html"><span>üîô</span><span data-toggle="tooltip" data-title="Building server side modules">
            Backend Modules
        </span></a>
    </li>
    <li>
        
    <div class="accordion">
        Site Templates
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 15l6 -6l6 6" />
        </svg>
    </div>
    
    <ul>
        
    <li>
        <a href="templates/template.html"><span>üì∞</span><span data-toggle="tooltip" data-title="Creating static web pages">
            Page Templates
        </span></a>
    </li>
    <li>
        <a href="templates/html.html"><span>üìê</span>HTML Template Literals</a>
    </li>
    <li>
        
    <div class="accordion">
        Default Template
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 15l6 -6l6 6" />
        </svg>
    </div>
    
    <ul>
        
    <li>
        <a href="../site/pages/normal/index.html"><span>üêò</span>Normal Page</a>
    </li>
    <li>
        <a href="../site/pages/landing/index.html"><span>üõ¨</span>Landing Page</a>
    </li>
    <li>
        <a href="../site/styles/theme.html"><span>üé®</span>Theming</a>
    </li>
    </ul>
    </li>
    </ul>
    </li>
    <li>
        
    <div class="accordion">
        Implementation
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 15l6 -6l6 6" />
        </svg>
    </div>
    
    <ul>
        
    <li>
        <a href="index.html"><span>üì∫</span><span data-toggle="tooltip" data-title="Main program and exports">
            Main Program
        </span></a>
    </li>
    <li>
        <a href="cli.html"><span>üêö</span><span data-toggle="tooltip" data-title="Scaffolding functionality">
            Command Line Interface
        </span></a>
    </li>
    <li>
        <a href="weaver.html" class="highlight"><span>üï∑Ô∏è</span><span data-toggle="tooltip" data-title="Common code for documentation generation">
            Weaver
        </span></a>
    </li>
    <li>
        <a href="md-weaver.html"><span>‚úçÔ∏è</span><span data-toggle="tooltip" data-title="Markdown generation code">
            Markdown Weaver
        </span></a>
    </li>
    <li>
        <a href="html-weaver.html"><span>üîó</span><span data-toggle="tooltip" data-title="HTML generation code">
            HTML Weaver
        </span></a>
    </li>
    <li>
        <a href="block-list.html"><span>üß±</span><span data-toggle="tooltip" data-title="Data structure for code/markdown fragments">
            Source Blocks
        </span></a>
    </li>
    <li>
        
    <div class="accordion">
        Translators
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M6 15l6 -6l6 6" />
        </svg>
    </div>
    
    <ul>
        
    <li>
        <a href="translators/translators.html"><span>üó£Ô∏è</span><span data-toggle="tooltip" data-title="Registering and getting translators">
            Translating Input Files
        </span></a>
    </li>
    <li>
        <a href="translators/base-translator.html"><span>üó£Ô∏è</span><span data-toggle="tooltip" data-title="Base class and other types related to translators">
            Translator Base Class
        </span></a>
    </li>
    <li>
        <a href="translators/md-translator.html"><span>üó£Ô∏è</span><span data-toggle="tooltip" data-title="Translator for markdown files">
            Markdown Translator
        </span></a>
    </li>
    <li>
        <a href="translators/ts-translator.html"><span>üó£Ô∏è</span><span data-toggle="tooltip" data-title="Common code for TypeScript translator">
            TypeScript Translator
        </span></a>
    </li>
    <li>
        <a href="translators/ts-html-translator.html"><span>üó£Ô∏è</span><span data-toggle="tooltip" data-title="Translating TypeScript to HTML">
            TypeScript Translator for HTML Output
        </span></a>
    </li>
    <li>
        <a href="translators/jsdoc-translator.html"><span>üó£Ô∏è</span>Generic JSDoc Translator</a>
    </li>
    </ul>
    </li>
    <li>
        <a href="utils.html"><span>üõ†Ô∏è</span><span data-toggle="tooltip" data-title="File path & directory utilities">
            Utilities
        </span></a>
    </li>
    <li>
        <a href="logging.html"><span>üìí</span><span data-toggle="tooltip" data-title="Outputting errors and progress to console">
            Logging
        </span></a>
    </li>
    </ul>
    </li>
    <li>
        <a href="../license.html"><span>üìú</span><span data-toggle="tooltip" data-title="License and usage information">
            License
        </span></a>
    </li>
    </ul>
        </div>
                <div class="toc-button"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevrons-right" viewBox="0 0 24 24" stroke-width="1.5" stroke="#2c3e50" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
            <path d="M7 7l5 5l-5 5" />
            <path d="M13 7l5 5l-5 5" />
        </svg></div>
            </div>
            
        <div class="contentarea closepopups">
            <h1 id="weaver">Weaver</h1>
<p>Weaver is the component that generates documentation for a project.
Its operation depends on the output format (markdown or HTML). Therefore,
weaver is defined as an abstract class which can be customized by overriding
certain methods. The abstract Weaver class contains the code common to both
markdown and HTML generation.</p>
<details>
<summary>weaver imports</summary>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="397" data-toggle="tooltip" data-title="typeof fs">fs</span> <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="423" data-toggle="tooltip" data-title="path.PlatformPath">path</span> <span class="keyword">from</span> <span class="string">&quot;path&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="453" data-toggle="tooltip" data-title="typeof ts">ts</span> <span class="keyword">from</span> <span class="string">&quot;typescript&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">{</span> <span id="489" data-toggle="tooltip" data-title="{ (p: string, pattern: string, options?: MinimatchOptions): boolean; sep: Sep; GLOBSTAR: typeof GLOBSTAR; filter: (pattern: string, options?: MinimatchOptions) =&gt; (p: string) =&gt; boolean; ... 7 more ...; unescape: (s: string, { windowsPathsNoEscape, }?: Pick&lt;MinimatchOptions, &quot;windowsPathsNoEscape&quot;&gt;) =&gt; string; }">minimatch</span> <span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">&quot;minimatch&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="526" data-toggle="tooltip" data-title="typeof cfg">cfg</span> <span class="keyword">from</span> <span class="string">&quot;./config&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="559" data-toggle="tooltip" data-title="typeof tr">tr</span> <span class="keyword">from</span> <span class="string">&quot;./translators/translators&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="608" data-toggle="tooltip" data-title="typeof bl">bl</span> <span class="keyword">from</span> <span class="string">&quot;./block-list&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="644" data-toggle="tooltip" data-title="typeof reg">reg</span> <span class="keyword">from</span> <span class="string">&quot;./region&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="677" data-toggle="tooltip" data-title="typeof resolver">resolver</span> <span class="keyword">from</span> <span class="string">&quot;./region-resolver&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="724" data-toggle="tooltip" data-title="typeof log">log</span> <span class="keyword">from</span> <span class="string">&quot;./logging&quot;</span><span class="punctuation">;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="758" data-toggle="tooltip" data-title="typeof dg">dg</span> <span class="keyword">from</span> <span class="string">&quot;./dependency-graph&quot;</span><span class="punctuation">;</span>
</code></pre>
</details>
<h2 id="weaver-base-class">Weaver Base Class</h2>
<p>Main functionality provided by the Weaver class includes retrieving all
the source files according to the configuration and feeding them to a
<a href="translators/translators.html">translator</a>. It splits an input file into
code and markdown blocks.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code><span class="keyword">const</span> <span id="1100" data-toggle="tooltip" data-title="1000">tocModifiedDelayInMs</span> <span class="punctuation">=</span> <span class="number">1000</span><span class="punctuation">;</span>

<span class="keyword">export</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span id="1129" class="typename" data-toggle="tooltip" data-title="Weaver">Weaver</span> <span class="punctuation">{</span>
  <span class="keyword">protected</span> <span id="1161" data-toggle="tooltip" data-title="ts.TypeChecker">typeChecker</span><span class="punctuation">:</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.TypeChecker">TypeChecker</span><span class="punctuation">;</span>
  <span class="keyword">protected</span> <span id="1202" data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1069"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFileMap">OutputFileMap</span></a><span class="punctuation">;</span>
  <span class="keyword">private</span> <span id="1243" data-toggle="tooltip" data-title="number">tocLastModified</span><span class="punctuation">:</span> <span class="keyword">number</span> <span class="punctuation">=</span> <span class="number">0</span><span class="punctuation">;</span>
</code></pre>
<h3 id="generating-all-files">Generating All Files</h3>
<p>The public method below takes a TypeScript <code>Program</code> object and generates
documentation for it. It first gathers all the files for which the
documentation is created. Then it creates a translator and processes
the files in two passes: first the TypeScript source files and then the
other files. The order is significant as <a href="region.html">regions</a>
defined in source files must be created before they can be used.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span id="1282" class="member" data-toggle="tooltip" data-title="(prg: ts.Program) =&gt; void">generateDocumentation</span><span class="punctuation">(</span><span id="1795" data-toggle="tooltip" data-title="ts.Program">prg</span><span class="punctuation">:</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.Program">Program</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a> <span class="punctuation">=</span> <span class="punctuation">{</span><span class="punctuation">}</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#6929"><span class="member" data-toggle="tooltip" data-title="(prg: ts.Program) =&gt; void">addTSFilesToOutputMap</span></a><span class="punctuation">(</span><a href="weaver.html#1795"><span data-toggle="tooltip" data-title="ts.Program">prg</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#10802"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">addOtherFilesToOutputMap</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1161"><span data-toggle="tooltip" data-title="ts.TypeChecker">typeChecker</span></a> <span class="punctuation">=</span> <a href="weaver.html#1795"><span data-toggle="tooltip" data-title="ts.Program">prg</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; ts.TypeChecker">getTypeChecker</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#2175"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">processAllFiles</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Map to store processed blocks before region resolution</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="1989" data-toggle="tooltip" data-title="Map&lt;string, { blocks: bl.BlockList; outFile: tr.OutputFile; }&gt;">processedBlocks</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Map&lt;K, V&gt;">Map</span><span class="punctuation">&lt;</span>
    <span class="keyword">string</span><span class="punctuation">,</span>
    <span class="punctuation">{</span> <span id="2111" data-toggle="tooltip" data-title="bl.BlockList">blocks</span><span class="punctuation">:</span> <a href="weaver.html#608"><span data-toggle="tooltip" data-title="any">bl</span></a><span class="punctuation">.</span><a href="block-list.html#582"><span class="typename" data-toggle="tooltip" data-title="bl.BlockList">BlockList</span></a><span class="punctuation">;</span> <span id="2133" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a> <span class="punctuation">}</span>
  <span class="punctuation">&gt;</span> <span class="punctuation">=</span> <span class="keyword">new</span> <span class="typename" data-toggle="tooltip" data-title="MapConstructor">Map</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
</code></pre>
<p>Generate all files in the output file map.</p>
<p>This is done in five passes:</p>
<ol>
<li>Scan all TypeScript files to collect region definitions</li>
<li>Process TypeScript files (creating blocks with region references)</li>
<li>Process other files (markdown, etc.) - also creates blocks with region references</li>
<li>Resolve ALL region references using topological sorting</li>
<li>Output all processed files</li>
</ol>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">protected</span> <span id="2175" class="member" data-toggle="tooltip" data-title="() =&gt; void">processAllFiles</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="weaver.html#644"><span data-toggle="tooltip" data-title="typeof reg">reg</span></a><span class="punctuation">.</span><a href="region.html#1908"><span class="typename" data-toggle="tooltip" data-title="typeof reg.Region">Region</span></a><span class="punctuation">.</span><a href="region.html#6976"><span class="member" data-toggle="tooltip" data-title="(definedInFile?: string) =&gt; void">clear</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1989"><span data-toggle="tooltip" data-title="Map&lt;string, { blocks: bl.BlockList; outFile: tr.OutputFile; }&gt;">processedBlocks</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; void">clear</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Pass 1: Scan TypeScript files to collect all regions</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#6779"><span class="member" data-toggle="tooltip" data-title="(kind: tr.SourceKind) =&gt; tr.OutputFile[]">getOutputFiles</span></a><span class="punctuation">(</span><a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#216"><span class="typename" data-toggle="tooltip" data-title="typeof tr.SourceKind">SourceKind</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#500"><span data-toggle="tooltip" data-title="tr.SourceKind.typescript">typescript</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callbackfn: (value: tr.OutputFile, index: number, array: tr.OutputFile[]) =&gt; void, thisArg?: any) =&gt; void">forEach</span><span class="punctuation">(</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#7803"><span class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">scanTsFileForRegions</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Pass 2: Process TypeScript files (store blocks, don&#039;t output yet)</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#6779"><span class="member" data-toggle="tooltip" data-title="(kind: tr.SourceKind) =&gt; tr.OutputFile[]">getOutputFiles</span></a><span class="punctuation">(</span><a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#216"><span class="typename" data-toggle="tooltip" data-title="typeof tr.SourceKind">SourceKind</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#500"><span data-toggle="tooltip" data-title="tr.SourceKind.typescript">typescript</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callbackfn: (value: tr.OutputFile, index: number, array: tr.OutputFile[]) =&gt; void, thisArg?: any) =&gt; void">forEach</span><span class="punctuation">(</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#8294"><span class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">processTsFileWithoutOutput</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Pass 3: Process other files (markdown, etc.) - store blocks, don&#039;t output yet</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#6779"><span class="member" data-toggle="tooltip" data-title="(kind: tr.SourceKind) =&gt; tr.OutputFile[]">getOutputFiles</span></a><span class="punctuation">(</span><a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#216"><span class="typename" data-toggle="tooltip" data-title="typeof tr.SourceKind">SourceKind</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#514"><span data-toggle="tooltip" data-title="tr.SourceKind.other">other</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callbackfn: (value: tr.OutputFile, index: number, array: tr.OutputFile[]) =&gt; void, thisArg?: any) =&gt; void">forEach</span><span class="punctuation">(</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#11449"><span class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">processOtherFileWithoutOutput</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Pass 4: Resolve all region references with topological sorting</span>
    <a href="weaver.html#677"><span data-toggle="tooltip" data-title="typeof resolver">resolver</span></a><span class="punctuation">.</span><a href="region-resolver.html#11599"><span class="member" data-toggle="tooltip" data-title="(processedBlocks: Map&lt;string, { blocks: bl.BlockList; outFile: any; }&gt;) =&gt; void">resolveAllRegions</span></a><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1989"><span data-toggle="tooltip" data-title="Map&lt;string, { blocks: bl.BlockList; outFile: tr.OutputFile; }&gt;">processedBlocks</span></a><span class="punctuation">)</span><span class="punctuation">;</span>

    <span class="comment">// Pass 5: Output all processed files with resolved regions</span>
    <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">const</span> <span class="punctuation">[</span><span id="3460" data-toggle="tooltip" data-title="string">_</span><span class="punctuation">,</span> <span class="punctuation">{</span> <span id="3464" data-toggle="tooltip" data-title="bl.BlockList">blocks</span><span class="punctuation">,</span> <span id="3472" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span> <span class="punctuation">}</span><span class="punctuation">]</span> <span class="keyword">of</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1989"><span data-toggle="tooltip" data-title="Map&lt;string, { blocks: bl.BlockList; outFile: tr.OutputFile; }&gt;">processedBlocks</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#5648"><span class="member" data-toggle="tooltip" data-title="(blocks: bl.BlockList, outputFile: tr.OutputFile) =&gt; void">outputBlocks</span></a><span class="punctuation">(</span><a href="weaver.html#3464"><span data-toggle="tooltip" data-title="bl.BlockList">blocks</span></a><span class="punctuation">,</span> <a href="weaver.html#3472"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>

    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#12873"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">saveDependencyGraph</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<h3 id="watching-changes">Watching Changes</h3>
<p>In watch mode we get a subtype of a <code>Program</code> object and use it to
process only the source files that are changed. If the output map is
not yet initialized, we call the <code>generateDocumentation</code> method to
build the whole documentation.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span id="3595" class="member" data-toggle="tooltip" data-title="(prg: ts.SemanticDiagnosticsBuilderProgram, complete: (prg: ts.SemanticDiagnosticsBuilderProgram) =&gt; void) =&gt; void">programChanged</span><span class="punctuation">(</span>
    <span id="3910" data-toggle="tooltip" data-title="ts.SemanticDiagnosticsBuilderProgram">prg</span><span class="punctuation">:</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.SemanticDiagnosticsBuilderProgram">SemanticDiagnosticsBuilderProgram</span><span class="punctuation">,</span>
    <span id="3957" data-toggle="tooltip" data-title="(prg: ts.SemanticDiagnosticsBuilderProgram) =&gt; void">complete</span><span class="punctuation">:</span> <span class="punctuation">(</span><span id="3973" data-toggle="tooltip" data-title="ts.SemanticDiagnosticsBuilderProgram">prg</span><span class="punctuation">:</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.SemanticDiagnosticsBuilderProgram">SemanticDiagnosticsBuilderProgram</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="keyword">void</span>
  <span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="4037" data-toggle="tooltip" data-title="{ result: readonly ts.Diagnostic[]; affected: ts.SourceFile | ts.Program; }">d</span> <span class="punctuation">=</span> <a href="weaver.html#3910"><span data-toggle="tooltip" data-title="ts.SemanticDiagnosticsBuilderProgram">prg</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(cancellationToken?: ts.CancellationToken, ignoreSourceFile?: (sourceFile: ts.SourceFile) =&gt; boolean) =&gt; ts.AffectedFileResult&lt;readonly ts.Diagnostic[]&gt;">getSemanticDiagnosticsOfNextAffectedFile</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">while</span> <span class="punctuation">(</span><a href="weaver.html#4037"><span data-toggle="tooltip" data-title="{ result: readonly ts.Diagnostic[]; affected: ts.SourceFile | ts.Program; }">d</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">let</span> <span id="4115" data-toggle="tooltip" data-title="ts.SourceFile | ts.Program">aff</span> <span class="punctuation">=</span> <a href="weaver.html#4037"><span data-toggle="tooltip" data-title="{ result: readonly ts.Diagnostic[]; affected: ts.SourceFile | ts.Program; }">d</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="ts.SourceFile | ts.Program">affected</span><span class="punctuation">;</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">(</span><a href="weaver.html#4115"><span data-toggle="tooltip" data-title="ts.SourceFile | ts.Program">aff</span></a> <span class="keyword">as</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.SourceFile">SourceFile</span><span class="punctuation">)</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="ts.SyntaxKind.SourceFile">kind</span><span class="punctuation">)</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#8986"><span class="member" data-toggle="tooltip" data-title="(sourceFile: ts.SourceFile) =&gt; void">reprocessSourceFile</span></a><span class="punctuation">(</span><a href="weaver.html#4115"><span data-toggle="tooltip" data-title="ts.SourceFile | ts.Program">aff</span></a> <span class="keyword">as</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.SourceFile">SourceFile</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">else</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#2175"><span class="member" data-toggle="tooltip" data-title="() =&gt; void">processAllFiles</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">break</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
      <a href="weaver.html#4037"><span data-toggle="tooltip" data-title="{ result: readonly ts.Diagnostic[]; affected: ts.SourceFile | ts.Program; }">d</span></a> <span class="punctuation">=</span> <a href="weaver.html#3910"><span data-toggle="tooltip" data-title="ts.SemanticDiagnosticsBuilderProgram">prg</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(cancellationToken?: ts.CancellationToken, ignoreSourceFile?: (sourceFile: ts.SourceFile) =&gt; boolean) =&gt; ts.AffectedFileResult&lt;readonly ts.Diagnostic[]&gt;">getSemanticDiagnosticsOfNextAffectedFile</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
    <a href="weaver.html#3957"><span data-toggle="tooltip" data-title="(prg: ts.SemanticDiagnosticsBuilderProgram) =&gt; void">complete</span></a><span class="punctuation">(</span><a href="weaver.html#3910"><span data-toggle="tooltip" data-title="ts.SemanticDiagnosticsBuilderProgram">prg</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<p>TypeScript compiler tracks only TS files, it does not notify us when
other files are changed. So, we must setup watchers for them separately.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span id="4383" class="member" data-toggle="tooltip" data-title="(host: ts.WatchCompilerHostOfConfigFile&lt;ts.SemanticDiagnosticsBuilderProgram&gt;) =&gt; void">watchOtherFiles</span><span class="punctuation">(</span>
    <span id="4566" data-toggle="tooltip" data-title="ts.WatchCompilerHostOfConfigFile&lt;ts.SemanticDiagnosticsBuilderProgram&gt;">host</span><span class="punctuation">:</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.WatchCompilerHostOfConfigFile&lt;T&gt;">WatchCompilerHostOfConfigFile</span><span class="punctuation">&lt;</span><a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.SemanticDiagnosticsBuilderProgram">SemanticDiagnosticsBuilderProgram</span><span class="punctuation">&gt;</span>
  <span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#6779"><span class="member" data-toggle="tooltip" data-title="(kind: tr.SourceKind) =&gt; tr.OutputFile[]">getOutputFiles</span></a><span class="punctuation">(</span><a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#216"><span class="typename" data-toggle="tooltip" data-title="typeof tr.SourceKind">SourceKind</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#514"><span data-toggle="tooltip" data-title="tr.SourceKind.other">other</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callbackfn: (value: tr.OutputFile, index: number, array: tr.OutputFile[]) =&gt; void, thisArg?: any) =&gt; void">forEach</span><span class="punctuation">(</span><span class="punctuation">(</span><span id="4708" data-toggle="tooltip" data-title="tr.OutputFile">of</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span>
      <a href="weaver.html#4566"><span data-toggle="tooltip" data-title="ts.WatchCompilerHostOfConfigFile&lt;ts.SemanticDiagnosticsBuilderProgram&gt;">host</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string, callback: ts.FileWatcherCallback, pollingInterval?: number, options?: ts.WatchOptions) =&gt; ts.FileWatcher">watchFile</span><span class="punctuation">(</span><a href="weaver.html#4708"><span data-toggle="tooltip" data-title="tr.OutputFile">of</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#979"><span data-toggle="tooltip" data-title="ts.SourceFile | tr.OtherFile">source</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">,</span> <span class="punctuation">(</span><span id="4757" data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">,</span> <span id="4766" data-toggle="tooltip" data-title="ts.FileWatcherEventKind">event</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="weaver.html#4766"><span data-toggle="tooltip" data-title="ts.FileWatcherEventKind">event</span></a> <span class="punctuation">==</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="typeof ts">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="typeof ts.FileWatcherEventKind">FileWatcherEventKind</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="ts.FileWatcherEventKind.Changed">Changed</span><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">let</span> <span id="4848" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a><span class="punctuation">[</span><a href="weaver.html#4757"><span data-toggle="tooltip" data-title="string">fileName</span></a><span class="punctuation">]</span><span class="punctuation">;</span>
          <span class="keyword">if</span> <span class="punctuation">(</span><a href="weaver.html#4848"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#9522"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; void">reprocessOtherFile</span></a><span class="punctuation">(</span><a href="weaver.html#4848"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
      <span class="punctuation">}</span><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="4975" data-toggle="tooltip" data-title="cfg.Options">opts</span> <span class="punctuation">=</span> <a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="weaver.html#4975"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#4582"><span data-toggle="tooltip" data-title="string">tocFile</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">let</span> <span id="5034" data-toggle="tooltip" data-title="string">tocPath</span> <span class="punctuation">=</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">resolve</span><span class="punctuation">(</span><a href="weaver.html#4975"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#2713"><span data-toggle="tooltip" data-title="string">outDir</span></a><span class="punctuation">,</span> <a href="weaver.html#4975"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#4582"><span data-toggle="tooltip" data-title="string">tocFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="weaver.html#4566"><span data-toggle="tooltip" data-title="ts.WatchCompilerHostOfConfigFile&lt;ts.SemanticDiagnosticsBuilderProgram&gt;">host</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string, callback: ts.FileWatcherCallback, pollingInterval?: number, options?: ts.WatchOptions) =&gt; ts.FileWatcher">watchFile</span><span class="punctuation">(</span><a href="weaver.html#5034"><span data-toggle="tooltip" data-title="string">tocPath</span></a><span class="punctuation">,</span> <span class="punctuation">(</span><span id="5117" data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">,</span> <span id="5126" data-toggle="tooltip" data-title="ts.FileWatcherEventKind">event</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="5150" data-toggle="tooltip" data-title="number">lastMod</span> <span class="punctuation">=</span> <a href="weaver.html#397"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="fs.StatSyncFn">statSync</span><span class="punctuation">(</span><a href="weaver.html#5034"><span data-toggle="tooltip" data-title="string">tocPath</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">mtimeMs</span><span class="punctuation">;</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="weaver.html#5150"><span data-toggle="tooltip" data-title="number">lastMod</span></a> <span class="punctuation">-</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1243"><span data-toggle="tooltip" data-title="number">tocLastModified</span></a> <span class="punctuation">&gt;</span> <a href="weaver.html#1100"><span data-toggle="tooltip" data-title="1000">tocModifiedDelayInMs</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
          <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1243"><span data-toggle="tooltip" data-title="number">tocLastModified</span></a> <span class="punctuation">=</span> <a href="weaver.html#5150"><span data-toggle="tooltip" data-title="number">lastMod</span></a><span class="punctuation">;</span>
          <span class="member" data-toggle="tooltip" data-title="typeof setTimeout">setTimeout</span><span class="punctuation">(</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
            <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#12761"><span class="member" data-toggle="tooltip" data-title="(tocFile: string) =&gt; void">tocFileChanged</span></a><span class="punctuation">(</span><a href="weaver.html#5117"><span data-toggle="tooltip" data-title="string">fileName</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
          <span class="punctuation">}</span><span class="punctuation">,</span> <a href="weaver.html#1100"><span data-toggle="tooltip" data-title="1000">tocModifiedDelayInMs</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="punctuation">}</span>
      <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<h3 id="abstract-methods">Abstract Methods</h3>
<p>The methods below are implemented in the sub-classes. The first one
returns the file extension for output files.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">protected</span> <span class="keyword">abstract</span> <span id="5439" class="member" data-toggle="tooltip" data-title="() =&gt; string">getFileExt</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">;</span>
</code></pre>
<p>The second one abstract method outputs a <a href="block-list.html">blocks list</a>
to a file.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">protected</span> <span class="keyword">abstract</span> <span id="5648" class="member" data-toggle="tooltip" data-title="(blocks: bl.BlockList, outputFile: tr.OutputFile) =&gt; void">outputBlocks</span><span class="punctuation">(</span>
    <span id="5788" data-toggle="tooltip" data-title="bl.BlockList">blocks</span><span class="punctuation">:</span> <a href="weaver.html#608"><span data-toggle="tooltip" data-title="any">bl</span></a><span class="punctuation">.</span><a href="block-list.html#582"><span class="typename" data-toggle="tooltip" data-title="bl.BlockList">BlockList</span></a><span class="punctuation">,</span>
    <span id="5814" data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a>
  <span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">void</span><span class="punctuation">;</span>
</code></pre>
<h3 id="helper-methods">Helper Methods</h3>
<p>The helper   function below returns an output path for a given input file.
It returns it both absolute and relative form. It also ensures that the
target path exists by creating the sub-folder on demand.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="5855" class="member" data-toggle="tooltip" data-title="(filePath: string) =&gt; [string, string]">targetPathFor</span><span class="punctuation">(</span><span id="6140" data-toggle="tooltip" data-title="string">filePath</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="keyword">string</span><span class="punctuation">,</span> <span class="keyword">string</span><span class="punctuation">]</span> <span class="punctuation">{</span>
    <span class="keyword">const</span> <span id="6187" data-toggle="tooltip" data-title="cfg.Options">opts</span> <span class="punctuation">=</span> <a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="6220" data-toggle="tooltip" data-title="string">relPath</span> <span class="punctuation">=</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(from: string, to: string) =&gt; string">relative</span><span class="punctuation">(</span><a href="weaver.html#6187"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#2499"><span data-toggle="tooltip" data-title="string">baseDir</span></a><span class="punctuation">,</span> <a href="weaver.html#6140"><span data-toggle="tooltip" data-title="string">filePath</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="6277" data-toggle="tooltip" data-title="path.ParsedPath">parsed</span> <span class="punctuation">=</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string) =&gt; path.ParsedPath">parse</span><span class="punctuation">(</span><a href="weaver.html#6220"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="6315" data-toggle="tooltip" data-title="string">targetPath</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#6548"><span class="member" data-toggle="tooltip" data-title="(subdir: string) =&gt; string">ensureOutDirExist</span></a><span class="punctuation">(</span><a href="weaver.html#6277"><span data-toggle="tooltip" data-title="path.ParsedPath">parsed</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">dir</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="6372" data-toggle="tooltip" data-title="string">res</span> <span class="punctuation">=</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">join</span><span class="punctuation">(</span><a href="weaver.html#6315"><span data-toggle="tooltip" data-title="string">targetPath</span></a><span class="punctuation">,</span> <a href="weaver.html#6277"><span data-toggle="tooltip" data-title="path.ParsedPath">parsed</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">name</span> <span class="punctuation">+</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#5439"><span class="member" data-toggle="tooltip" data-title="() =&gt; string">getFileExt</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">return</span> <span class="punctuation">[</span>
      <a href="weaver.html#6372"><span data-toggle="tooltip" data-title="string">res</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (searchValue: string | RegExp, replaceValue: string): string; (searchValue: string | RegExp, replacer: (substring: string, ...args: any[]) =&gt; string): string; (searchValue: { [Symbol.replace](string: string, replaceValue: string): string; }, replaceValue: string): string; (searchValue: { [Symbol.replace](string: s...">replace</span><span class="punctuation">(</span><span class="string">/\\/g</span><span class="punctuation">,</span> <span class="string">&quot;/&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>
      <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(from: string, to: string) =&gt; string">relative</span><span class="punctuation">(</span><a href="weaver.html#6187"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#2713"><span data-toggle="tooltip" data-title="string">outDir</span></a><span class="punctuation">,</span> <a href="weaver.html#6372"><span data-toggle="tooltip" data-title="string">res</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (searchValue: string | RegExp, replaceValue: string): string; (searchValue: string | RegExp, replacer: (substring: string, ...args: any[]) =&gt; string): string; (searchValue: { [Symbol.replace](string: string, replaceValue: string): string; }, replaceValue: string): string; (searchValue: { [Symbol.replace](string: s...">replace</span><span class="punctuation">(</span><span class="string">/\\/g</span><span class="punctuation">,</span> <span class="string">&quot;/&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span>
    <span class="punctuation">]</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  <span class="keyword">private</span> <span id="6548" class="member" data-toggle="tooltip" data-title="(subdir: string) =&gt; string">ensureOutDirExist</span><span class="punctuation">(</span><span id="6578" data-toggle="tooltip" data-title="string">subdir</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="6603" data-toggle="tooltip" data-title="string">targetPath</span> <span class="punctuation">=</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">resolve</span><span class="punctuation">(</span><a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="config.html#2713"><span data-toggle="tooltip" data-title="string">outDir</span></a><span class="punctuation">,</span> <a href="weaver.html#6578"><span data-toggle="tooltip" data-title="string">subdir</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="weaver.html#397"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: fs.PathLike) =&gt; boolean">existsSync</span><span class="punctuation">(</span><a href="weaver.html#6603"><span data-toggle="tooltip" data-title="string">targetPath</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
      <a href="weaver.html#397"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (path: fs.PathLike, options: fs.MakeDirectoryOptions &amp; { recursive: true; }): string | undefined; (path: fs.PathLike, options?: fs.Mode | (fs.MakeDirectoryOptions &amp; { recursive?: false | undefined; }) | null): void; (path: fs.PathLike, options?: fs.Mode | fs.MakeDirectoryOptions | null): string | undefined; }">mkdirSync</span><span class="punctuation">(</span><a href="weaver.html#6603"><span data-toggle="tooltip" data-title="string">targetPath</span></a><span class="punctuation">,</span> <span class="punctuation">{</span> <span id="6732" data-toggle="tooltip" data-title="true">recursive</span><span class="punctuation">:</span> <span class="keyword">true</span> <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">return</span> <a href="weaver.html#6603"><span data-toggle="tooltip" data-title="string">targetPath</span></a><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  <span class="keyword">private</span> <span id="6779" class="member" data-toggle="tooltip" data-title="(kind: tr.SourceKind) =&gt; tr.OutputFile[]">getOutputFiles</span><span class="punctuation">(</span><span id="6806" data-toggle="tooltip" data-title="tr.SourceKind">kind</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#216"><span class="typename" data-toggle="tooltip" data-title="tr.SourceKind">SourceKind</span></a><span class="punctuation">)</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="typename" data-toggle="tooltip" data-title="ObjectConstructor">Object</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(o: { [s: string]: T; } | ArrayLike&lt;T&gt;): T[]; (o: {}): any[]; }">values</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;S extends tr.OutputFile&gt;(predicate: (value: tr.OutputFile, index: number, array: tr.OutputFile[]) =&gt; value is S, thisArg?: any): S[]; (predicate: (value: tr.OutputFile, index: number, array: tr.OutputFile[]) =&gt; unknown, thisArg?: any): tr.OutputFile[]; }">filter</span><span class="punctuation">(</span><span class="punctuation">(</span><span id="6895" data-toggle="tooltip" data-title="tr.OutputFile">of</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <a href="weaver.html#6895"><span data-toggle="tooltip" data-title="tr.OutputFile">of</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#953"><span data-toggle="tooltip" data-title="tr.SourceKind">sourceKind</span></a> <span class="punctuation">==</span> <a href="weaver.html#6806"><span data-toggle="tooltip" data-title="tr.SourceKind">kind</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<h3 id="processing-type-script-files">Processing TypeScript Files</h3>
<p>The method below constructs a map (or a dictionary) that contains the
source files to be processed. It skips declaration files because they
are outside of the project, and any files that are specified to be
excluded in the configuration.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="6929" class="member" data-toggle="tooltip" data-title="(prg: ts.Program) =&gt; void">addTSFilesToOutputMap</span><span class="punctuation">(</span><span id="7274" data-toggle="tooltip" data-title="ts.Program">prg</span><span class="punctuation">:</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.Program">Program</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="7300" data-toggle="tooltip" data-title="cfg.Options">opts</span> <span class="punctuation">=</span> <a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">const</span> <span id="7340" data-toggle="tooltip" data-title="ts.SourceFile">source</span> <span class="keyword">of</span> <a href="weaver.html#7274"><span data-toggle="tooltip" data-title="ts.Program">prg</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; readonly ts.SourceFile[]">getSourceFiles</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">let</span> <span id="7384" data-toggle="tooltip" data-title="string">relPath</span> <span class="punctuation">=</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(from: string, to: string) =&gt; string">relative</span><span class="punctuation">(</span><a href="weaver.html#7300"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#2499"><span data-toggle="tooltip" data-title="string">baseDir</span></a><span class="punctuation">,</span> <a href="weaver.html#7340"><span data-toggle="tooltip" data-title="ts.SourceFile">source</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><span class="punctuation">(</span><a href="weaver.html#7340"><span data-toggle="tooltip" data-title="ts.SourceFile">source</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="boolean">isDeclarationFile</span> <span class="punctuation">||</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#10669"><span class="member" data-toggle="tooltip" data-title="(relPath: string) =&gt; boolean">excludePath</span></a><span class="punctuation">(</span><a href="weaver.html#7384"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span class="punctuation">[</span><span id="7524" data-toggle="tooltip" data-title="string">fullTargetPath</span><span class="punctuation">,</span> <span id="7539" data-toggle="tooltip" data-title="string">relTargetPath</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#5855"><span class="member" data-toggle="tooltip" data-title="(filePath: string) =&gt; [string, string]">targetPathFor</span></a><span class="punctuation">(</span>
          <a href="weaver.html#7340"><span data-toggle="tooltip" data-title="ts.SourceFile">source</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span>
        <span class="punctuation">)</span><span class="punctuation">;</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a><span class="punctuation">[</span><a href="weaver.html#7340"><span data-toggle="tooltip" data-title="ts.SourceFile">source</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">{</span>
          <span id="7657" data-toggle="tooltip" data-title="tr.SourceKind.typescript">sourceKind</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#216"><span class="typename" data-toggle="tooltip" data-title="typeof tr.SourceKind">SourceKind</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#500"><span data-toggle="tooltip" data-title="tr.SourceKind.typescript">typescript</span></a><span class="punctuation">,</span>
          <span id="7705" data-toggle="tooltip" data-title="string">fullTargetPath</span><span class="punctuation">,</span>
          <span id="7731" data-toggle="tooltip" data-title="string">relTargetPath</span><span class="punctuation">,</span>
          <span id="7756" data-toggle="tooltip" data-title="ts.SourceFile">source</span><span class="punctuation">,</span>
        <span class="punctuation">}</span><span class="punctuation">;</span>
      <span class="punctuation">}</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<p>Once the file map is created it is quite simple to just traverse through
it and feed the files to a translator. The block list produced is then
written to disk by calling the abstract <code>outputBlocks</code> method.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="7803" class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">scanTsFileForRegions</span><span class="punctuation">(</span><span id="8069" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="8102" data-toggle="tooltip" data-title="tr.Translator">translator</span> <span class="punctuation">=</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/translators.html#1899"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, checker?: ts.TypeChecker, outputMap?: tr.OutputFileMap) =&gt; tr.Translator">getTranslator</span></a><span class="punctuation">(</span>
      <a href="weaver.html#8069"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1161"><span data-toggle="tooltip" data-title="ts.TypeChecker">typeChecker</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a>
    <span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="comment">// Scan for regions without generating blocks</span>
    <a href="weaver.html#8102"><span data-toggle="tooltip" data-title="tr.Translator">translator</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#2423"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; void">scanForRegions</span></a><span class="punctuation">(</span><a href="weaver.html#8069"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  <span class="keyword">private</span> <span id="8294" class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">processTsFileWithoutOutput</span><span class="punctuation">(</span><span id="8333" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="weaver.html#724"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#3913"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; void">reportWeaverProgress</span></a><span class="punctuation">(</span><a href="weaver.html#8333"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="8405" data-toggle="tooltip" data-title="tr.Translator">translator</span> <span class="punctuation">=</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/translators.html#1899"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, checker?: ts.TypeChecker, outputMap?: tr.OutputFileMap) =&gt; tr.Translator">getTranslator</span></a><span class="punctuation">(</span>
      <a href="weaver.html#8333"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1161"><span data-toggle="tooltip" data-title="ts.TypeChecker">typeChecker</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a>
    <span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="8511" data-toggle="tooltip" data-title="bl.BlockList">blocks</span> <span class="punctuation">=</span> <a href="weaver.html#8405"><span data-toggle="tooltip" data-title="tr.Translator">translator</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#2177"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; bl.BlockList">getBlocksForFile</span></a><span class="punctuation">(</span><a href="weaver.html#8333"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="comment">// Store blocks instead of outputting immediately</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1989"><span data-toggle="tooltip" data-title="Map&lt;string, { blocks: bl.BlockList; outFile: tr.OutputFile; }&gt;">processedBlocks</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(key: string, value: { blocks: bl.BlockList; outFile: tr.OutputFile; }) =&gt; Map&lt;string, { blocks: bl.BlockList; outFile: tr.OutputFile; }&gt;">set</span><span class="punctuation">(</span><a href="weaver.html#8333"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1016"><span data-toggle="tooltip" data-title="string">fullTargetPath</span></a><span class="punctuation">,</span> <span class="punctuation">{</span> <span id="8667" data-toggle="tooltip" data-title="bl.BlockList">blocks</span><span class="punctuation">,</span> <span id="8675" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span> <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  <span class="keyword">private</span> <span id="8691" class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">processTsFile</span><span class="punctuation">(</span><span id="8717" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="weaver.html#724"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#3913"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; void">reportWeaverProgress</span></a><span class="punctuation">(</span><a href="weaver.html#8717"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="8789" data-toggle="tooltip" data-title="tr.Translator">translator</span> <span class="punctuation">=</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/translators.html#1899"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, checker?: ts.TypeChecker, outputMap?: tr.OutputFileMap) =&gt; tr.Translator">getTranslator</span></a><span class="punctuation">(</span>
      <a href="weaver.html#8717"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1161"><span data-toggle="tooltip" data-title="ts.TypeChecker">typeChecker</span></a><span class="punctuation">,</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a>
    <span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="8895" data-toggle="tooltip" data-title="bl.BlockList">blocks</span> <span class="punctuation">=</span> <a href="weaver.html#8789"><span data-toggle="tooltip" data-title="tr.Translator">translator</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#2177"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; bl.BlockList">getBlocksForFile</span></a><span class="punctuation">(</span><a href="weaver.html#8717"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#5648"><span class="member" data-toggle="tooltip" data-title="(blocks: bl.BlockList, outputFile: tr.OutputFile) =&gt; void">outputBlocks</span></a><span class="punctuation">(</span><a href="weaver.html#8895"><span data-toggle="tooltip" data-title="bl.BlockList">blocks</span></a><span class="punctuation">,</span> <a href="weaver.html#8717"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<h3 id="reprocessing-changed-files">Reprocessing Changed Files</h3>
<p>If we are reprocessing a TypeScript file, we update the <code>Source</code> object
and remove the regions defined in the file before calling the
<code>processTsFile</code> method.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">protected</span> <span id="8986" class="member" data-toggle="tooltip" data-title="(sourceFile: ts.SourceFile) =&gt; void">reprocessSourceFile</span><span class="punctuation">(</span><span id="9245" data-toggle="tooltip" data-title="ts.SourceFile">sourceFile</span><span class="punctuation">:</span> <a href="weaver.html#453"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.SourceFile">SourceFile</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="9281" data-toggle="tooltip" data-title="string">fileName</span> <span class="punctuation">=</span> <a href="weaver.html#9245"><span data-toggle="tooltip" data-title="ts.SourceFile">sourceFile</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="9321" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a><span class="punctuation">[</span><a href="weaver.html#9281"><span data-toggle="tooltip" data-title="string">fileName</span></a><span class="punctuation">]</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><a href="weaver.html#9321"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span> <span class="keyword">return</span><span class="punctuation">;</span>
    <a href="weaver.html#644"><span data-toggle="tooltip" data-title="typeof reg">reg</span></a><span class="punctuation">.</span><a href="region.html#1908"><span class="typename" data-toggle="tooltip" data-title="typeof reg.Region">Region</span></a><span class="punctuation">.</span><a href="region.html#6976"><span class="member" data-toggle="tooltip" data-title="(definedInFile?: string) =&gt; void">clear</span></a><span class="punctuation">(</span><a href="weaver.html#9281"><span data-toggle="tooltip" data-title="string">fileName</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <a href="weaver.html#9321"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#979"><span data-toggle="tooltip" data-title="ts.SourceFile | tr.OtherFile">source</span></a> <span class="punctuation">=</span> <a href="weaver.html#9245"><span data-toggle="tooltip" data-title="ts.SourceFile">sourceFile</span></a><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#8691"><span class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">processTsFile</span></a><span class="punctuation">(</span><a href="weaver.html#9321"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#12525"><span class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">outputFileChanged</span></a><span class="punctuation">(</span><a href="weaver.html#9321"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  <span class="keyword">protected</span> <span id="9522" class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; void">reprocessOtherFile</span><span class="punctuation">(</span><span id="9555" data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#12166"><span class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">processOtherFile</span></a><span class="punctuation">(</span><a href="weaver.html#9555"><span data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#12525"><span class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">outputFileChanged</span></a><span class="punctuation">(</span><a href="weaver.html#9555"><span data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<h3 id="processing-other-files">Processing Other Files</h3>
<p>To gather the other files we browse through all subdirectories in the
project root folder. We do this in a generator that yields each file in
turn.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span class="punctuation">*</span><span id="9666" class="member" data-toggle="tooltip" data-title="(dir: string) =&gt; Iterable&lt;string&gt;">getOtherFiles</span><span class="punctuation">(</span><span id="9904" data-toggle="tooltip" data-title="string">dir</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="typename" data-toggle="tooltip" data-title="Iterable&lt;T, TReturn, TNext&gt;">Iterable</span><span class="punctuation">&lt;</span><span class="keyword">string</span><span class="punctuation">&gt;</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="9944" data-toggle="tooltip" data-title="cfg.Options">opts</span> <span class="punctuation">=</span> <a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="weaver.html#9904"><span data-toggle="tooltip" data-title="string">dir</span></a> <span class="punctuation">==</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">resolve</span><span class="punctuation">(</span><a href="weaver.html#9944"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#2713"><span data-toggle="tooltip" data-title="string">outDir</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="keyword">return</span><span class="punctuation">;</span>
    <span class="keyword">const</span> <span id="10029" data-toggle="tooltip" data-title="string[]">paths</span> <span class="punctuation">=</span> <a href="weaver.html#397"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (path: fs.PathLike, options?: { encoding: BufferEncoding | null; withFileTypes?: false | undefined; recursive?: boolean | undefined; } | BufferEncoding | null): string[]; (path: fs.PathLike, options: { encoding: &quot;buffer&quot;; withFileTypes?: false | undefined; recursive?: boolean | undefined; } | &quot;buffer&quot;): NonSharedB...">readdirSync</span><span class="punctuation">(</span><a href="weaver.html#9904"><span data-toggle="tooltip" data-title="string">dir</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="10071" data-toggle="tooltip" data-title="string">subPath</span> <span class="keyword">of</span> <a href="weaver.html#10029"><span data-toggle="tooltip" data-title="string[]">paths</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">let</span> <span id="10101" data-toggle="tooltip" data-title="string">res</span> <span class="punctuation">=</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">resolve</span><span class="punctuation">(</span><a href="weaver.html#9904"><span data-toggle="tooltip" data-title="string">dir</span></a><span class="punctuation">,</span> <a href="weaver.html#10071"><span data-toggle="tooltip" data-title="string">subPath</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">let</span> <span id="10145" data-toggle="tooltip" data-title="string">relPath</span> <span class="punctuation">=</span> <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(from: string, to: string) =&gt; string">relative</span><span class="punctuation">(</span><a href="weaver.html#9944"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#2499"><span data-toggle="tooltip" data-title="string">baseDir</span></a><span class="punctuation">,</span> <a href="weaver.html#10101"><span data-toggle="tooltip" data-title="string">res</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">if</span> <span class="punctuation">(</span><a href="weaver.html#397"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="fs.StatSyncFn">statSync</span><span class="punctuation">(</span><a href="weaver.html#10101"><span data-toggle="tooltip" data-title="string">res</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; boolean">isDirectory</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#10669"><span class="member" data-toggle="tooltip" data-title="(relPath: string) =&gt; boolean">excludePath</span></a><span class="punctuation">(</span><a href="weaver.html#10145"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="keyword">yield</span><span class="punctuation">*</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#9666"><span class="member" data-toggle="tooltip" data-title="(dir: string) =&gt; Iterable&lt;string&gt;">getOtherFiles</span></a><span class="punctuation">(</span><a href="weaver.html#10101"><span data-toggle="tooltip" data-title="string">res</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="punctuation">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#10370"><span class="member" data-toggle="tooltip" data-title="(relPath: string) =&gt; boolean">includePath</span></a><span class="punctuation">(</span><a href="weaver.html#10145"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="keyword">yield</span> <a href="weaver.html#10101"><span data-toggle="tooltip" data-title="string">res</span></a><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<p>We need to determine whether a file is included or excluded based on the
configuration settings.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="10370" class="member" data-toggle="tooltip" data-title="(relPath: string) =&gt; boolean">includePath</span><span class="punctuation">(</span><span id="10512" data-toggle="tooltip" data-title="string">relPath</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">boolean</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <span class="punctuation">(</span>
      <a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="config.html#3212"><span data-toggle="tooltip" data-title="string[]">files</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(predicate: (value: string, index: number, array: string[]) =&gt; unknown, thisArg?: any) =&gt; boolean">some</span><span class="punctuation">(</span><span class="punctuation">(</span><span id="10588" data-toggle="tooltip" data-title="string">glob</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <a href="weaver.html#489"><span data-toggle="tooltip" data-title="{ (p: string, pattern: string, options?: MinimatchOptions): boolean; sep: Sep; GLOBSTAR: typeof GLOBSTAR; filter: (pattern: string, options?: MinimatchOptions) =&gt; (p: string) =&gt; boolean; ... 7 more ...; unescape: (s: string, { windowsPathsNoEscape, }?: Pick&lt;MinimatchOptions, &quot;windowsPathsNoEscape&quot;&gt;) =&gt; string; }">minimatch</span></a><span class="punctuation">(</span><a href="weaver.html#10512"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">,</span> <a href="weaver.html#10588"><span data-toggle="tooltip" data-title="string">glob</span></a><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">&amp;&amp;</span>
      <span class="punctuation">!</span><span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#10669"><span class="member" data-toggle="tooltip" data-title="(relPath: string) =&gt; boolean">excludePath</span></a><span class="punctuation">(</span><a href="weaver.html#10512"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">)</span>
    <span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  <span class="keyword">private</span> <span id="10669" class="member" data-toggle="tooltip" data-title="(relPath: string) =&gt; boolean">excludePath</span><span class="punctuation">(</span><span id="10693" data-toggle="tooltip" data-title="string">relPath</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">boolean</span> <span class="punctuation">{</span>
    <span class="keyword">return</span> <a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="config.html#3815"><span data-toggle="tooltip" data-title="string[]">exclude</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(predicate: (value: string, index: number, array: string[]) =&gt; unknown, thisArg?: any) =&gt; boolean">some</span><span class="punctuation">(</span><span class="punctuation">(</span><span id="10763" data-toggle="tooltip" data-title="string">glob</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <a href="weaver.html#489"><span data-toggle="tooltip" data-title="{ (p: string, pattern: string, options?: MinimatchOptions): boolean; sep: Sep; GLOBSTAR: typeof GLOBSTAR; filter: (pattern: string, options?: MinimatchOptions) =&gt; (p: string) =&gt; boolean; ... 7 more ...; unescape: (s: string, { windowsPathsNoEscape, }?: Pick&lt;MinimatchOptions, &quot;windowsPathsNoEscape&quot;&gt;) =&gt; string; }">minimatch</span></a><span class="punctuation">(</span><a href="weaver.html#10693"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">,</span> <a href="weaver.html#10763"><span data-toggle="tooltip" data-title="string">glob</span></a><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<p>The loop that processes other files is also quite simple. The contents
of each file is read and passed to the translator. The generated block
list is saved to a file by the abstract outputBlocks method.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="10802" class="member" data-toggle="tooltip" data-title="() =&gt; void">addOtherFilesToOutputMap</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="11079" data-toggle="tooltip" data-title="string">baseDir</span> <span class="punctuation">=</span> <a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="config.html#2499"><span data-toggle="tooltip" data-title="string">baseDir</span></a><span class="punctuation">;</span>
    <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="11128" data-toggle="tooltip" data-title="string">mdFile</span> <span class="keyword">of</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#9666"><span class="member" data-toggle="tooltip" data-title="(dir: string) =&gt; Iterable&lt;string&gt;">getOtherFiles</span></a><span class="punctuation">(</span><a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">resolve</span><span class="punctuation">(</span><a href="weaver.html#11079"><span data-toggle="tooltip" data-title="string">baseDir</span></a><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
      <span class="keyword">let</span> <span class="punctuation">[</span><span id="11195" data-toggle="tooltip" data-title="string">fullTargetPath</span><span class="punctuation">,</span> <span id="11210" data-toggle="tooltip" data-title="string">relTargetPath</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#5855"><span class="member" data-toggle="tooltip" data-title="(filePath: string) =&gt; [string, string]">targetPathFor</span></a><span class="punctuation">(</span><a href="weaver.html#11128"><span data-toggle="tooltip" data-title="string">mdFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
      <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1202"><span data-toggle="tooltip" data-title="tr.OutputFileMap">outputMap</span></a><span class="punctuation">[</span><a href="weaver.html#11128"><span data-toggle="tooltip" data-title="string">mdFile</span></a><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">{</span>
        <span id="11288" data-toggle="tooltip" data-title="tr.SourceKind.other">sourceKind</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#216"><span class="typename" data-toggle="tooltip" data-title="typeof tr.SourceKind">SourceKind</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#514"><span data-toggle="tooltip" data-title="tr.SourceKind.other">other</span></a><span class="punctuation">,</span>
        <span id="11329" data-toggle="tooltip" data-title="string">fullTargetPath</span><span class="punctuation">,</span>
        <span id="11353" data-toggle="tooltip" data-title="string">relTargetPath</span><span class="punctuation">,</span>
        <span id="11376" data-toggle="tooltip" data-title="{ fileName: string; contents: null; }">source</span><span class="punctuation">:</span> <span class="punctuation">{</span> <span id="11394" data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">:</span> <a href="weaver.html#11128"><span data-toggle="tooltip" data-title="string">mdFile</span></a><span class="punctuation">,</span> <span id="11412" data-toggle="tooltip" data-title="null">contents</span><span class="punctuation">:</span> <span class="keyword">null</span> <span class="punctuation">}</span><span class="punctuation">,</span>
      <span class="punctuation">}</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
</code></pre>
<p>There is a gotcha in the <code>readFileSync</code> function that we need to
take care of. The function adds whitespace at the beginning of
the contents string which messes up the markdown to HTML
transformation if we don't trim it out.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="11449" class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">processOtherFileWithoutOutput</span><span class="punctuation">(</span><span id="11747" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="weaver.html#724"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#3913"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; void">reportWeaverProgress</span></a><span class="punctuation">(</span><a href="weaver.html#11747"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">(</span><a href="weaver.html#11747"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#979"><span data-toggle="tooltip" data-title="ts.SourceFile | tr.OtherFile">source</span></a> <span class="keyword">as</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#525"><span class="typename" data-toggle="tooltip" data-title="tr.OtherFile">OtherFile</span></a><span class="punctuation">)</span><span class="punctuation">.</span><a href="translators/base-translator.html#661"><span data-toggle="tooltip" data-title="string">contents</span></a> <span class="punctuation">=</span> <a href="weaver.html#397"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a>
      <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (path: fs.PathOrFileDescriptor, options?: { encoding?: null | undefined; flag?: string | undefined; } | null): NonSharedBuffer; (path: fs.PathOrFileDescriptor, options: { encoding: BufferEncoding; flag?: string | undefined; } | BufferEncoding): string; (path: fs.PathOrFileDescriptor, options?: (fs.ObjectEncodingOp...">readFileSync</span><span class="punctuation">(</span><a href="weaver.html#11747"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#979"><span data-toggle="tooltip" data-title="ts.SourceFile | tr.OtherFile">source</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">,</span> <span class="string">&quot;utf8&quot;</span><span class="punctuation">)</span>
      <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">trim</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="11938" data-toggle="tooltip" data-title="tr.Translator">translator</span> <span class="punctuation">=</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/translators.html#1899"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, checker?: ts.TypeChecker, outputMap?: tr.OutputFileMap) =&gt; tr.Translator">getTranslator</span></a><span class="punctuation">(</span><a href="weaver.html#11747"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="11986" data-toggle="tooltip" data-title="bl.BlockList">blocks</span> <span class="punctuation">=</span> <a href="weaver.html#11938"><span data-toggle="tooltip" data-title="tr.Translator">translator</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#2177"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; bl.BlockList">getBlocksForFile</span></a><span class="punctuation">(</span><a href="weaver.html#11747"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="comment">// Store blocks instead of outputting immediately</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#1989"><span data-toggle="tooltip" data-title="Map&lt;string, { blocks: bl.BlockList; outFile: tr.OutputFile; }&gt;">processedBlocks</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(key: string, value: { blocks: bl.BlockList; outFile: tr.OutputFile; }) =&gt; Map&lt;string, { blocks: bl.BlockList; outFile: tr.OutputFile; }&gt;">set</span><span class="punctuation">(</span><a href="weaver.html#11747"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1016"><span data-toggle="tooltip" data-title="string">fullTargetPath</span></a><span class="punctuation">,</span> <span class="punctuation">{</span> <span id="12142" data-toggle="tooltip" data-title="bl.BlockList">blocks</span><span class="punctuation">,</span> <span id="12150" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span> <span class="punctuation">}</span><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>

  <span class="keyword">private</span> <span id="12166" class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">processOtherFile</span><span class="punctuation">(</span><span id="12195" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
    <a href="weaver.html#724"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#3913"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; void">reportWeaverProgress</span></a><span class="punctuation">(</span><a href="weaver.html#12195"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">(</span><a href="weaver.html#12195"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#979"><span data-toggle="tooltip" data-title="ts.SourceFile | tr.OtherFile">source</span></a> <span class="keyword">as</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#525"><span class="typename" data-toggle="tooltip" data-title="tr.OtherFile">OtherFile</span></a><span class="punctuation">)</span><span class="punctuation">.</span><a href="translators/base-translator.html#661"><span data-toggle="tooltip" data-title="string">contents</span></a> <span class="punctuation">=</span> <a href="weaver.html#397"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a>
      <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (path: fs.PathOrFileDescriptor, options?: { encoding?: null | undefined; flag?: string | undefined; } | null): NonSharedBuffer; (path: fs.PathOrFileDescriptor, options: { encoding: BufferEncoding; flag?: string | undefined; } | BufferEncoding): string; (path: fs.PathOrFileDescriptor, options?: (fs.ObjectEncodingOp...">readFileSync</span><span class="punctuation">(</span><a href="weaver.html#12195"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#979"><span data-toggle="tooltip" data-title="ts.SourceFile | tr.OtherFile">source</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">fileName</span><span class="punctuation">,</span> <span class="string">&quot;utf8&quot;</span><span class="punctuation">)</span>
      <span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">trim</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="12386" data-toggle="tooltip" data-title="tr.Translator">translator</span> <span class="punctuation">=</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="typeof tr">tr</span></a><span class="punctuation">.</span><a href="translators/translators.html#1899"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, checker?: ts.TypeChecker, outputMap?: tr.OutputFileMap) =&gt; tr.Translator">getTranslator</span></a><span class="punctuation">(</span><a href="weaver.html#12195"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">let</span> <span id="12434" data-toggle="tooltip" data-title="bl.BlockList">blocks</span> <span class="punctuation">=</span> <a href="weaver.html#12386"><span data-toggle="tooltip" data-title="tr.Translator">translator</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#2177"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile) =&gt; bl.BlockList">getBlocksForFile</span></a><span class="punctuation">(</span><a href="weaver.html#12195"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">this</span><span class="punctuation">.</span><a href="weaver.html#5648"><span class="member" data-toggle="tooltip" data-title="(blocks: bl.BlockList, outputFile: tr.OutputFile) =&gt; void">outputBlocks</span></a><span class="punctuation">(</span><a href="weaver.html#12434"><span data-toggle="tooltip" data-title="bl.BlockList">blocks</span></a><span class="punctuation">,</span> <a href="weaver.html#12195"><span data-toggle="tooltip" data-title="tr.OutputFile">outFile</span></a><span class="punctuation">)</span><span class="punctuation">;</span>
  <span class="punctuation">}</span>
</code></pre>
<h3 id="change-events">Change Events</h3>
<p>When a file has been changed are reweaved, this method is called.
Subclasses can override the method to run live reloading, etc.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">protected</span> <span id="12525" class="member" data-toggle="tooltip" data-title="(outFile: tr.OutputFile) =&gt; void">outputFileChanged</span><span class="punctuation">(</span><span id="12735" data-toggle="tooltip" data-title="tr.OutputFile">outFile</span><span class="punctuation">:</span> <a href="weaver.html#559"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#683"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">)</span> <span class="punctuation">{</span><span class="punctuation">}</span>
</code></pre>
<p>This method is called when TOC file is changed.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">protected</span> <span id="12761" class="member" data-toggle="tooltip" data-title="(tocFile: string) =&gt; void">tocFileChanged</span><span class="punctuation">(</span><span id="12854" data-toggle="tooltip" data-title="string">tocFile</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">{</span><span class="punctuation">}</span>
</code></pre>
<h3 id="saving-depenency-graph">Saving Depenency Graph</h3>
<p>After all the files are processed, dependency graph is saved to a file
designated in configuration.</p>
<pre class="syntaxhighlight narrow-scrollbars"><code>  <span class="keyword">private</span> <span id="12873" class="member" data-toggle="tooltip" data-title="() =&gt; void">saveDependencyGraph</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
    <span class="keyword">let</span> <span id="13074" data-toggle="tooltip" data-title="cfg.Options">opts</span> <span class="punctuation">=</span> <a href="weaver.html#526"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8716"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="keyword">if</span> <span class="punctuation">(</span><a href="weaver.html#13074"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#5204"><span data-toggle="tooltip" data-title="string">dependencyGraph</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
      <a href="weaver.html#724"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#4994"><span class="member" data-toggle="tooltip" data-title="(output: string) =&gt; void">info</span></a><span class="punctuation">(</span>
        <span class="string">`Saving dependency graph to ${</span><a href="weaver.html#724"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#336"><span class="typename" data-toggle="tooltip" data-title="typeof log.Colors">Colors</span></a><span class="punctuation">.</span><a href="logging.html#626"><span data-toggle="tooltip" data-title="log.Colors.Blue">Blue</span></a><span class="string">}${</span><a href="weaver.html#13074"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#5204"><span data-toggle="tooltip" data-title="string">dependencyGraph</span></a><span class="string">}`</span>
      <span class="punctuation">)</span><span class="punctuation">;</span>
      <a href="weaver.html#397"><span data-toggle="tooltip" data-title="typeof fs">fs</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(file: fs.PathOrFileDescriptor, data: string | NodeJS.ArrayBufferView, options?: fs.WriteFileOptions) =&gt; void">writeFileSync</span><span class="punctuation">(</span>
        <a href="weaver.html#423"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">resolve</span><span class="punctuation">(</span><a href="weaver.html#13074"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#2713"><span data-toggle="tooltip" data-title="string">outDir</span></a><span class="punctuation">,</span> <a href="weaver.html#13074"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#5204"><span data-toggle="tooltip" data-title="string">dependencyGraph</span></a><span class="punctuation">)</span><span class="punctuation">,</span>
        <span class="typename" data-toggle="tooltip" data-title="JSON">JSON</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (value: any, replacer?: (this: any, key: string, value: any) =&gt; any, space?: string | number): string; (value: any, replacer?: (number | string)[] | null, space?: string | number): string; }">stringify</span><span class="punctuation">(</span><a href="weaver.html#758"><span data-toggle="tooltip" data-title="typeof dg">dg</span></a><span class="punctuation">.</span><a href="dependency-graph.html#1876"><span class="member" data-toggle="tooltip" data-title="() =&gt; dg.DependencyGraph">getDependencyGraph</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="keyword">null</span><span class="punctuation">,</span> <span class="number">4</span><span class="punctuation">)</span>
      <span class="punctuation">)</span><span class="punctuation">;</span>
    <span class="punctuation">}</span>
  <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>

        </div>
            <div class="sidepane narrow-scrollbars">
                
        <div class="pagemenu">
            <h3>On This Page</h3>
                <ul class="pagetree">
                </ul>
        </div>
            </div>
        </div>
        
        <div class="footer">
            <a class="footer-button" href="cli.html">
            <p>Previous</p>
            <p>¬´ Command Line Interface</p>
        </a>
            <div class="footer-text">
                <p>Copyright ¬© 2024 Tommi Johtela</p>
                <p>Generated by 
                    <a href="https://johtela.github.io/litscript">LiTScript</a>
                </p>
            </div>
            <a class="footer-button" href="md-weaver.html">
            <p>Next</p>
            <p>Markdown Weaver ¬ª</p>
        </a>
        </div>
    
        <script src="../dist/normal.js"></script>
    </body>
    </html>