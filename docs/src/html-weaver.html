
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>LiTScript - HTML Weaver</title>
    <link rel="icon" type="image/icon" href="../images/favicon.png" />
    <link rel="stylesheet" href="../css/main.css" />
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css">
</head>
<body>
    
    <div class="navbar">
        <div class="navmenu">
            
    <a class="title enabled" href="../index.html">
        <img src="../images/bulb.svg" />
        <span>LiTScript</span>
    </a>
    <a class="enabled" href="https://www.npmjs.com/package/litscript">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M288 288h-32v-64h32v64zm288-128v192H288v32H160v-32H0V160h576zm-416 32H32v128h64v-96h32v96h32V192zm160 0H192v160h64v-32h64V192zm224 0H352v128h64v-96h32v96h32v-96h32v96h32V192z"/></svg>
        <span>Download</span>
    </a>
    <a class="enabled" href="https://github.com/johtela/litscript">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
        <span>GitHub</span>
    </a>
    <a class="enabled" href="../license.html">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zM64 72c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8V72zm0 64c0-4.42 3.58-8 8-8h80c4.42 0 8 3.58 8 8v16c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16zm192.81 248H304c8.84 0 16 7.16 16 16s-7.16 16-16 16h-47.19c-16.45 0-31.27-9.14-38.64-23.86-2.95-5.92-8.09-6.52-10.17-6.52s-7.22.59-10.02 6.19l-7.67 15.34a15.986 15.986 0 0 1-14.31 8.84c-.38 0-.75-.02-1.14-.05-6.45-.45-12-4.75-14.03-10.89L144 354.59l-10.61 31.88c-5.89 17.66-22.38 29.53-41 29.53H80c-8.84 0-16-7.16-16-16s7.16-16 16-16h12.39c4.83 0 9.11-3.08 10.64-7.66l18.19-54.64c3.3-9.81 12.44-16.41 22.78-16.41s19.48 6.59 22.77 16.41l13.88 41.64c19.77-16.19 54.05-9.7 66 14.16 2.02 4.06 5.96 6.5 10.16 6.5zM377 105L279.1 7c-4.5-4.5-10.6-7-17-7H256v128h128v-6.1c0-6.3-2.5-12.4-7-16.9z"/></svg>
        <span>License</span>
    </a>
    <a class="enabled" href="md-weaver.html">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M223.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L319.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L393.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34zm-192 34l136 136c9.4 9.4 24.6 9.4 33.9 0l22.6-22.6c9.4-9.4 9.4-24.6 0-33.9L127.9 256l96.4-96.4c9.4-9.4 9.4-24.6 0-33.9L201.7 103c-9.4-9.4-24.6-9.4-33.9 0l-136 136c-9.5 9.4-9.5 24.6-.1 34z"/></svg>
        <span>Previous: Markdown Weaver</span>
    </a>
    <a class="enabled" href="block-list.html">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34zm192-34l-136-136c-9.4-9.4-24.6-9.4-33.9 0l-22.6 22.6c-9.4 9.4-9.4 24.6 0 33.9l96.4 96.4-96.4 96.4c-9.4 9.4-9.4 24.6 0 33.9l22.6 22.6c9.4 9.4 24.6 9.4 33.9 0l136-136c9.4-9.2 9.4-24.4 0-33.8z"/></svg>
        <span>Next: Source Blocks</span>
    </a>
        </div>
        
    <a class="hamburger">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
    </div>
    
    <div class="layout">
        <div class="sidepane collapsible">
            
    <div class="tocmenu">
        <h3>Table of Contents</h3>
        
    <ul>
        
    <li>
        
        <a href="../index.html"><span data-toggle="tooltip" data-title="Home page">Home</span></a>
        
    </li>
    <li>
        
        <a href="../introduction.html"><span data-toggle="tooltip" data-title="Introduction and Motivation">Introduction</span></a>
        
    </li>
    <li>
        
        <a href="config.html"><span data-toggle="tooltip" data-title="Configuration options and command line parsing">Configuration</span></a>
        
    </li>
    <li>
        
        <a href="region.html"><span data-toggle="tooltip" data-title="Embedding Regions of Code in Markdown">Regions</span></a>
        
    </li>
    <li>
        
        <a href="visualizer.html"><span data-toggle="tooltip" data-title="Adding dynamic content to HTML pages">Visualizers</span></a>
        
    </li>
    <li>
        
        <a href="dependency-graph.html"><span data-toggle="tooltip" data-title="Creating module dependency graph">Dependency Graph</span></a>
        
    </li>
    <li>
        
        <a href="bundler.html"><span data-toggle="tooltip" data-title="Packing JS & CSS files">Bundler</span></a>
        
    </li>
    <li>
        <button class="accordion">
        Implementation
        </button>
            
    <ul>
        
    <li>
        
        <a href="index.html"><span data-toggle="tooltip" data-title="Main program and exports">Main Program</span></a>
        
    </li>
    <li>
        
        <a href="cli.html"><span data-toggle="tooltip" data-title="Scaffolding functionality">Command Line Interface</span></a>
        
    </li>
    <li>
        
        <a href="weaver.html"><span data-toggle="tooltip" data-title="Common code for documentation generation">Weaver</span></a>
        
    </li>
    <li>
        
        <a href="md-weaver.html"><span data-toggle="tooltip" data-title="Markdown generation code">Markdown Weaver</span></a>
        
    </li>
    <li>
        
        <a href="html-weaver.html" class="highlight"><span data-toggle="tooltip" data-title="HTML generation code">HTML Weaver</span></a>
        
    </li>
    <li>
        
        <a href="block-list.html"><span data-toggle="tooltip" data-title="Data structure for code/markdown fragments">Source Blocks</span></a>
        
    </li>
    <li>
        <button class="accordion">
        Translators
        </button>
            
    <ul>
        
    <li>
        
        <a href="translators/translators.html"><span data-toggle="tooltip" data-title="Registering and getting translators">Translating Input Files</span></a>
        
    </li>
    <li>
        
        <a href="translators/base-translator.html"><span data-toggle="tooltip" data-title="Base class and other types related to translators">Translator Base Class</span></a>
        
    </li>
    <li>
        
        <a href="translators/md-translator.html"><span data-toggle="tooltip" data-title="Translator for markdown files">Markdown Translator</span></a>
        
    </li>
    <li>
        
        <a href="translators/ts-translator.html"><span data-toggle="tooltip" data-title="Common code for TypeScript translator">TypeScript Translator</span></a>
        
    </li>
    <li>
        
        <a href="translators/ts-html-translator.html"><span data-toggle="tooltip" data-title="Translating TypeScript to HTML">TypeScript Translator for HTML Output</span></a>
        
    </li>
    <li>
        
        <a href="translators/jsdoc-translator.html">Generic JSDoc Translator</a>
        
    </li>
    </ul>
    </li>
    <li>
        
        <a href="logging.html"><span data-toggle="tooltip" data-title="Outputting errors and progress to console">Logging</span></a>
        
    </li>
    </ul>
    </li>
    <li>
        
        <a href="../license.html"><span data-toggle="tooltip" data-title="License and usage information">License</span></a>
        
    </li>
    </ul>
    </div>
            
        </div>
        <div class="sideicon collapsible">
            
    <a class="hamburger">
        <div class="bar1"></div>
        <div class="bar2"></div>
        <div class="bar3"></div>
    </a>
        </div>
        <div class="scrollingarea closepopups">
            
    <div class="contentarea">
        
<h1 id="html-weaver">HTML Weaver</h1>
<p>When HTML is selected as an output format, the weaver class needs to do more
work:</p>
<ul>
<li>Manage TOC loading, saving, and updating.</li>
<li>Keep track of dynamic code files (see <a href="visualizer.html">visualizers</a>).</li>
<li>Convert markdown blocks to HTML. This involves also adding syntax
highlighting to TypeScript code blocks written inside markdown.</li>
<li>Call the template to transform HTML snippets into valid web pages.</li>
<li>Call the <a href="bundler.html">bundler</a> to pack the dependencies of the
generated HTML files to single JS and CSS files.</li>
</ul>
<h2 id="imports">Imports</h2>
<p>We use <a href="https://github.com/markdown-it/markdown-it">markdown-it</a> library to convert markdown to HTML. We customize it
with couple of plug-ins that:</p>
<ul>
<li>add IDs to heading tags (<a href="https://github.com/rstacruz/markdown-it-named-headings">markdown-it-named-headings</a>),</li>
<li>provide support for <a href="https://katex.org/">KaTeX</a> math equations (<a href="https://github.com/waylonflinn/markdown-it-katex">markdown-it-katex</a>),</li>
<li>parse <a href="front-matter.html">front matter</a> at the beginning of a file
(<a href="https://github.com/craigdmckenna/markdown-it-front-matter">markdown-it-front-matter</a>), and</li>
<li>allow resizing images (<a href="https://github.com/tatsy/markdown-it-imsize">markdown-it-imsize</a>).</li>
</ul>
<pre class="syntaxhighlight"><code><span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="1521" data-toggle="tooltip" data-title="path.PlatformPath">path</span> <span class="keyword">from</span> <span class="string">&#039;path&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="1551" data-toggle="tooltip" data-title="typeof mm">mm</span> <span class="keyword">from</span> <span class="string">&#039;minimatch&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="1584" data-toggle="tooltip" data-title="typeof ts">ts</span> <span class="keyword">from</span> <span class="string">&#039;typescript&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="1618" data-toggle="tooltip" data-title="typeof tmp">tmp</span> <span class="keyword">from</span> <span class="string">&#039;lits-template&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="1656" data-toggle="tooltip" data-title="MarkdownItConstructor">MarkdownIt</span> <span class="keyword">from</span> <span class="string">&#039;markdown-it&#039;</span>
<span class="keyword">import</span> <span id="1691" data-toggle="tooltip" data-title="any">mditNamedHeadings</span> <span class="punctuation">=</span> <span class="keyword">require</span><span class="punctuation">(</span><span class="string">&#039;markdown-it-named-headings&#039;</span><span class="punctuation">)</span>
<span class="keyword">import</span> <span id="1757" data-toggle="tooltip" data-title="any">mditKatex</span> <span class="punctuation">=</span> <span class="keyword">require</span><span class="punctuation">(</span><span class="string">&#039;@iktakahiro/markdown-it-katex&#039;</span><span class="punctuation">)</span>
<span class="keyword">import</span> <span id="1818" data-toggle="tooltip" data-title="any">mditImSize</span> <span class="punctuation">=</span> <span class="keyword">require</span><span class="punctuation">(</span><span class="string">&quot;markdown-it-imsize&quot;</span><span class="punctuation">)</span>
<span class="keyword">const</span> <span id="1876" data-toggle="tooltip" data-title="any">mditFrontMatter</span> <span class="punctuation">=</span> <span data-toggle="tooltip" data-title="NodeRequire">require</span><span class="punctuation">(</span><span class="string">&quot;markdown-it-front-matter&quot;</span><span class="punctuation">)</span>
<span class="keyword">import</span> <span class="punctuation">{</span> <span id="1940" data-toggle="tooltip" data-title="any">HLJSApi</span> <span class="punctuation">}</span> <span class="keyword">from</span> <span class="string">&#039;highlight.js&#039;</span>
<span class="keyword">const</span> <span id="1977" data-toggle="tooltip" data-title="HLJSApi">hljs</span> <span class="punctuation">=</span> <span data-toggle="tooltip" data-title="NodeRequire">require</span><span class="punctuation">(</span><span class="string">&#039;highlight.js&#039;</span><span class="punctuation">)</span> <span class="keyword">as</span> <a href="html-weaver.html#1940"><span data-toggle="tooltip" data-title="HLJSApi">HLJSApi</span></a>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="2027" data-toggle="tooltip" data-title="typeof cfg">cfg</span> <span class="keyword">from</span> <span class="string">&#039;./config&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="2060" data-toggle="tooltip" data-title="typeof bl">bl</span> <span class="keyword">from</span> <span class="string">&#039;./block-list&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="2096" data-toggle="tooltip" data-title="typeof tr">tr</span> <span class="keyword">from</span> <span class="string">&#039;./translators/translators&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="2145" data-toggle="tooltip" data-title="typeof wv">wv</span> <span class="keyword">from</span> <span class="string">&#039;./weaver&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="2177" data-toggle="tooltip" data-title="typeof bnd">bnd</span> <span class="keyword">from</span> <span class="string">&#039;./bundler&#039;</span>
<span class="keyword">import</span> <span class="punctuation">*</span> <span class="keyword">as</span> <span id="2211" data-toggle="tooltip" data-title="typeof log">log</span> <span class="keyword">from</span> <span class="string">&#039;./logging&#039;</span>
</code></pre>
<h2 id="instance-variables">Instance Variables</h2>
<p>We store inside a <code>HtmlWeaver</code> object variables that are needed in the process.</p>
<pre class="syntaxhighlight"><code><span class="keyword">export</span> <span class="keyword">class</span> <span id="2237" class="typename" data-toggle="tooltip" data-title="HtmlWeaver">HtmlWeaver</span> <span class="keyword">extends</span> <a href="html-weaver.html#2145"><span data-toggle="tooltip" data-title="typeof wv">wv</span></a><span class="punctuation">.</span><a href="weaver.html#756"><span class="typename" data-toggle="tooltip" data-title="typeof wv.Weaver">Weaver</span></a> <span class="punctuation">{</span>
</code></pre>
<p>Reference to the markdown parser.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">private</span> <span id="2407" data-toggle="tooltip" data-title="MarkdownIt">mdit</span><span class="punctuation">:</span> <a href="html-weaver.html#1656"><span data-toggle="tooltip" data-title="MarkdownIt">MarkdownIt</span></a>
</code></pre>
<p>We also keep the active front matter up-to-date. If a source file
contains overrides to the global settings, they will only appear here.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">private</span> <span id="2497" data-toggle="tooltip" data-title="tmp.FrontMatter">frontMatter</span><span class="punctuation">:</span> <a href="html-weaver.html#1618"><span data-toggle="tooltip" data-title="any">tmp</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="tmp.FrontMatter">FrontMatter</span>
</code></pre>
<p>Currently open table of contents.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">private</span> <span id="2711" data-toggle="tooltip" data-title="tmp.Toc">toc</span><span class="punctuation">:</span> <a href="html-weaver.html#1618"><span data-toggle="tooltip" data-title="any">tmp</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="tmp.Toc">Toc</span>
</code></pre>
<p>The dynamic code files referenced in the markdown are stored in a
dictionary.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">public</span> <span id="2797" data-toggle="tooltip" data-title="bnd.CodeFiles">codeFiles</span><span class="punctuation">:</span> <a href="html-weaver.html#2177"><span data-toggle="tooltip" data-title="any">bnd</span></a><span class="punctuation">.</span><a href="bundler.html#1373"><span class="typename" data-toggle="tooltip" data-title="bnd.CodeFiles">CodeFiles</span></a>
</code></pre>
<h2 id="overriding-the-main-method">Overriding the Main Method</h2>
<p>We override the <code>generateDocumentation</code> method to instantiate markdown-it
and its plug-ins.</p>
<pre class="syntaxhighlight"><code>    <span id="2947" class="member" data-toggle="tooltip" data-title="(prg: ts.Program) =&gt; void">generateDocumentation</span><span class="punctuation">(</span><span id="3149" data-toggle="tooltip" data-title="ts.Program">prg</span><span class="punctuation">:</span> <a href="html-weaver.html#1584"><span data-toggle="tooltip" data-title="any">ts</span></a><span class="punctuation">.</span><span class="typename" data-toggle="tooltip" data-title="ts.Program">Program</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a> <span class="punctuation">=</span> <span class="keyword">new</span> <a href="html-weaver.html#1656"><span data-toggle="tooltip" data-title="MarkdownItConstructor">MarkdownIt</span></a><span class="punctuation">(</span><span class="punctuation">{</span> <span id="3205" data-toggle="tooltip" data-title="true">html</span><span class="punctuation">:</span> <span class="keyword">true</span> <span class="punctuation">}</span><span class="punctuation">)</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (plugin: MarkdownIt.PluginSimple): MarkdownIt; &lt;T = any&gt;(plugin: MarkdownIt.PluginWithOptions&lt;T&gt;, options?: T): MarkdownIt; (plugin: MarkdownIt.PluginWithParams, ...params: any[]): MarkdownIt; }">use</span><span class="punctuation">(</span><a href="html-weaver.html#1757"><span data-toggle="tooltip" data-title="any">mditKatex</span></a><span class="punctuation">)</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (plugin: MarkdownIt.PluginSimple): MarkdownIt; &lt;T = any&gt;(plugin: MarkdownIt.PluginWithOptions&lt;T&gt;, options?: T): MarkdownIt; (plugin: MarkdownIt.PluginWithParams, ...params: any[]): MarkdownIt; }">use</span><span class="punctuation">(</span><a href="html-weaver.html#1691"><span data-toggle="tooltip" data-title="any">mditNamedHeadings</span></a><span class="punctuation">)</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (plugin: MarkdownIt.PluginSimple): MarkdownIt; &lt;T = any&gt;(plugin: MarkdownIt.PluginWithOptions&lt;T&gt;, options?: T): MarkdownIt; (plugin: MarkdownIt.PluginWithParams, ...params: any[]): MarkdownIt; }">use</span><span class="punctuation">(</span><a href="html-weaver.html#1818"><span data-toggle="tooltip" data-title="any">mditImSize</span></a><span class="punctuation">)</span>
        <span class="keyword">let</span> <span id="3343" data-toggle="tooltip" data-title="cfg.Options">opts</span> <span class="punctuation">=</span> <a href="html-weaver.html#2027"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#7250"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
</code></pre>
<p>If a front matter block is encountered at the start of a file, we
parse it and merge the settings with the global front matter object.
Since there might be parsing errors, we need to catch and report
them to the calling function.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (plugin: MarkdownIt.PluginSimple): MarkdownIt; &lt;T = any&gt;(plugin: MarkdownIt.PluginWithOptions&lt;T&gt;, options?: T): MarkdownIt; (plugin: MarkdownIt.PluginWithParams, ...params: any[]): MarkdownIt; }">use</span><span class="punctuation">(</span><a href="html-weaver.html#1876"><span data-toggle="tooltip" data-title="any">mditFrontMatter</span></a><span class="punctuation">,</span> <span class="punctuation">(</span><span id="3715" data-toggle="tooltip" data-title="string">fmstr</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
            <span class="keyword">try</span> <span class="punctuation">{</span>
                <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2497"><span data-toggle="tooltip" data-title="tmp.FrontMatter">frontMatter</span></a> <span class="punctuation">=</span> <span class="typename" data-toggle="tooltip" data-title="JSON">JSON</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(text: string, reviver?: (this: any, key: string, value: any) =&gt; any) =&gt; any">parse</span><span class="punctuation">(</span><a href="html-weaver.html#3715"><span data-toggle="tooltip" data-title="string">fmstr</span></a><span class="punctuation">)</span>
                <a href="html-weaver.html#2027"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#8629"><span class="member" data-toggle="tooltip" data-title="(source: object, target: object) =&gt; void">mergeOptions</span></a><span class="punctuation">(</span><a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#6036"><span data-toggle="tooltip" data-title="tmp.FrontMatter">frontMatter</span></a><span class="punctuation">,</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2497"><span data-toggle="tooltip" data-title="tmp.FrontMatter">frontMatter</span></a><span class="punctuation">)</span>
            <span class="punctuation">}</span>
            <span class="keyword">catch</span> <span class="punctuation">(</span><span id="3913" data-toggle="tooltip" data-title="any">e</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                <span class="keyword">throw</span> <a href="html-weaver.html#3913"><span data-toggle="tooltip" data-title="any">e</span></a> <span class="keyword">instanceof</span> <span class="typename" data-toggle="tooltip" data-title="SyntaxErrorConstructor">SyntaxError</span> <span class="punctuation">?</span>
                    <span class="typename" data-toggle="tooltip" data-title="ErrorConstructor">Error</span><span class="punctuation">(</span><span class="string">&quot;Could not parse front matter. Error: \n&quot;</span> <span class="punctuation">+</span>
                        <a href="html-weaver.html#3913"><span data-toggle="tooltip" data-title="SyntaxError">e</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">message</span><span class="punctuation">)</span> <span class="punctuation">:</span> <a href="html-weaver.html#3913"><span data-toggle="tooltip" data-title="any">e</span></a>
            <span class="punctuation">}</span>
        <span class="punctuation">}</span><span class="punctuation">)</span>
</code></pre>
<p>Configure <a href="https://highlightjs.readthedocs.io/en/latest/index.html">highlight.js</a> to omit style class prefixes.</p>
<pre class="syntaxhighlight"><code>        <a href="html-weaver.html#1977"><span data-toggle="tooltip" data-title="HLJSApi">hljs</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="(options: Partial&lt;HLJSOptions&gt;) =&gt; void">configure</span><span class="punctuation">(</span><span class="punctuation">{</span>
            <span id="4323" data-toggle="tooltip" data-title="string">classPrefix</span><span class="punctuation">:</span> <span class="string">&#039;&#039;</span>
        <span class="punctuation">}</span><span class="punctuation">)</span>
</code></pre>
<p>We initialize the rest of the instance variables defined above.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2797"><span data-toggle="tooltip" data-title="bnd.CodeFiles">codeFiles</span></a> <span class="punctuation">=</span> <span class="punctuation">{</span>
            <span id="4494" data-toggle="tooltip" data-title="null">main</span><span class="punctuation">:</span> <span class="keyword">null</span>
        <span class="punctuation">}</span>
</code></pre>
<p>We load the TOC before calling the inherited method and save it
afterwards, if so requested in configuration. As the last step, we
bundle the deployment files.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">let</span> <span id="4765" data-toggle="tooltip" data-title="string">tocFile</span> <span class="punctuation">=</span> <a href="html-weaver.html#1521"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">resolve</span><span class="punctuation">(</span><a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#1929"><span data-toggle="tooltip" data-title="string">outDir</span></a><span class="punctuation">,</span> <a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#4069"><span data-toggle="tooltip" data-title="string">tocFile</span></a><span class="punctuation">)</span>
        <a href="html-weaver.html#2211"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#4588"><span class="member" data-toggle="tooltip" data-title="(output: string) =&gt; void">info</span></a><span class="punctuation">(</span><span class="string">`Loading TOC from ${</span><a href="html-weaver.html#2211"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#351"><span class="typename" data-toggle="tooltip" data-title="typeof log.Colors">Colors</span></a><span class="punctuation">.</span><a href="logging.html#654"><span data-toggle="tooltip" data-title="log.Colors.Blue">Blue</span></a><span class="string">}${</span><a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#4069"><span data-toggle="tooltip" data-title="string">tocFile</span></a><span class="string">}`</span><span class="punctuation">)</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2711"><span data-toggle="tooltip" data-title="tmp.Toc">toc</span></a> <span class="punctuation">=</span> <a href="html-weaver.html#1618"><span data-toggle="tooltip" data-title="typeof tmp">tmp</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(tocFile: string) =&gt; tmp.Toc">loadToc</span><span class="punctuation">(</span><a href="html-weaver.html#4765"><span data-toggle="tooltip" data-title="string">tocFile</span></a><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2711"><span data-toggle="tooltip" data-title="tmp.Toc">toc</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">==</span> <span class="number">0</span><span class="punctuation">)</span>
            <a href="html-weaver.html#2211"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#4443"><span class="member" data-toggle="tooltip" data-title="(output: string) =&gt; void">warn</span></a><span class="punctuation">(</span><span class="string">&quot;TOC not found or empty.&quot;</span><span class="punctuation">)</span>
        <span class="keyword">super</span><span class="punctuation">.</span><a href="weaver.html#1187"><span class="member" data-toggle="tooltip" data-title="(prg: ts.Program) =&gt; void">generateDocumentation</span></a><span class="punctuation">(</span><a href="html-weaver.html#3149"><span data-toggle="tooltip" data-title="ts.Program">prg</span></a><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#4364"><span data-toggle="tooltip" data-title="boolean">updateToc</span></a><span class="punctuation">)</span> <span class="punctuation">{</span>
            <a href="html-weaver.html#2211"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#4588"><span class="member" data-toggle="tooltip" data-title="(output: string) =&gt; void">info</span></a><span class="punctuation">(</span><span class="string">`Saving TOC to ${</span><a href="html-weaver.html#2211"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#351"><span class="typename" data-toggle="tooltip" data-title="typeof log.Colors">Colors</span></a><span class="punctuation">.</span><a href="logging.html#654"><span data-toggle="tooltip" data-title="log.Colors.Blue">Blue</span></a><span class="string">}${</span><a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#4069"><span data-toggle="tooltip" data-title="string">tocFile</span></a><span class="string">}`</span><span class="punctuation">)</span>
            <a href="html-weaver.html#1618"><span data-toggle="tooltip" data-title="typeof tmp">tmp</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(toc: tmp.Toc, tocFile: string) =&gt; void">saveToc</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2711"><span data-toggle="tooltip" data-title="tmp.Toc">toc</span></a><span class="punctuation">,</span> <a href="html-weaver.html#4765"><span data-toggle="tooltip" data-title="string">tocFile</span></a><span class="punctuation">)</span>
        <span class="punctuation">}</span>
        <a href="html-weaver.html#2211"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#4588"><span class="member" data-toggle="tooltip" data-title="(output: string) =&gt; void">info</span></a><span class="punctuation">(</span><span class="string">`Copying auxiliary files to ${</span><a href="html-weaver.html#2211"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#351"><span class="typename" data-toggle="tooltip" data-title="typeof log.Colors">Colors</span></a><span class="punctuation">.</span><a href="logging.html#654"><span data-toggle="tooltip" data-title="log.Colors.Blue">Blue</span></a><span class="string">}${</span><a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#1929"><span data-toggle="tooltip" data-title="string">outDir</span></a><span class="string">}`</span><span class="punctuation">)</span>
        <a href="html-weaver.html#2027"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#9842"><span class="member" data-toggle="tooltip" data-title="() =&gt; tmp.Template">getTemplate</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(fullBasePath: string) =&gt; void">copyAuxiliaryFiles</span><span class="punctuation">(</span><a href="html-weaver.html#1521"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...paths: string[]) =&gt; string">resolve</span><span class="punctuation">(</span><a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#1929"><span data-toggle="tooltip" data-title="string">outDir</span></a><span class="punctuation">)</span><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="html-weaver.html#3343"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#5417"><span data-toggle="tooltip" data-title="boolean">bundle</span></a><span class="punctuation">)</span>
            <a href="html-weaver.html#2177"><span data-toggle="tooltip" data-title="typeof bnd">bnd</span></a><span class="punctuation">.</span><a href="bundler.html#8729"><span class="member" data-toggle="tooltip" data-title="(codeFiles: bnd.CodeFiles) =&gt; void">bundle</span></a><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2797"><span data-toggle="tooltip" data-title="bnd.CodeFiles">codeFiles</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
</code></pre>
<p>The output extension is <code>.html</code></p>
<pre class="syntaxhighlight"><code>    <span class="keyword">protected</span> <span id="5440" class="member" data-toggle="tooltip" data-title="() =&gt; string">getFileExt</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">return</span> <span class="string">&quot;.html&quot;</span>
    <span class="punctuation">}</span>
</code></pre>
<h2 id="adding-toc-entries">Adding TOC Entries</h2>
<p>We add new pages to TOC, if the corresponding setting is on in the
configuration, and if the file path is not defined to be excluded.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">protected</span> <span id="5559" class="member" data-toggle="tooltip" data-title="(relPath: string) =&gt; void">addTocEntry</span><span class="punctuation">(</span><span id="5795" data-toggle="tooltip" data-title="string">relPath</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="5826" data-toggle="tooltip" data-title="cfg.Options">opts</span> <span class="punctuation">=</span> <a href="html-weaver.html#2027"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#7250"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="html-weaver.html#5826"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#4364"><span data-toggle="tooltip" data-title="boolean">updateToc</span></a> <span class="punctuation">&amp;&amp;</span>
            <span class="punctuation">!</span><a href="html-weaver.html#5826"><span data-toggle="tooltip" data-title="cfg.Options">opts</span></a><span class="punctuation">.</span><a href="config.html#4746"><span data-toggle="tooltip" data-title="string[]">excludeFromToc</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(predicate: (value: string, index: number, array: string[]) =&gt; unknown, thisArg?: any) =&gt; boolean">some</span><span class="punctuation">(</span><span id="5921" data-toggle="tooltip" data-title="string">glob</span> <span class="punctuation">=&gt;</span> <a href="html-weaver.html#1551"><span data-toggle="tooltip" data-title="typeof mm">mm</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="{ (p: string, pattern: string, options?: mm.MinimatchOptions): boolean; sep: Sep; GLOBSTAR: unique symbol; filter: (pattern: string, options?: mm.MinimatchOptions) =&gt; (p: string) =&gt; boolean; ... 7 more ...; unescape: (s: string, { windowsPathsNoEscape, }?: Pick&lt;...&gt;) =&gt; string; }">minimatch</span><span class="punctuation">(</span><a href="html-weaver.html#5795"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">,</span> <a href="html-weaver.html#5921"><span data-toggle="tooltip" data-title="string">glob</span></a><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">)</span>
            <a href="html-weaver.html#1618"><span data-toggle="tooltip" data-title="typeof tmp">tmp</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(toc: tmp.Toc, page: string, file: string) =&gt; void">addTocEntry</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2711"><span data-toggle="tooltip" data-title="tmp.Toc">toc</span></a><span class="punctuation">,</span>
                <a href="html-weaver.html#1521"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string, suffix?: string) =&gt; string">basename</span><span class="punctuation">(</span><a href="html-weaver.html#5795"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">,</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#5440"><span class="member" data-toggle="tooltip" data-title="() =&gt; string">getFileExt</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> <a href="html-weaver.html#5795"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
</code></pre>
<h2 id="saving-blocks">Saving Blocks</h2>
<p>The HTML conversion is done before blocks are saved. The <code>outputBlocks</code>
method overridde first renders the blocks to HTML using a subroutine
defined below.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">protected</span> <span id="6073" class="member" data-toggle="tooltip" data-title="(blocks: bl.BlockList, outputFile: tr.OutputFile, visualizerCalls: tr.VisualizerCall[]) =&gt; void">outputBlocks</span><span class="punctuation">(</span><span id="6336" data-toggle="tooltip" data-title="bl.BlockList">blocks</span><span class="punctuation">:</span> <a href="html-weaver.html#2060"><span data-toggle="tooltip" data-title="any">bl</span></a><span class="punctuation">.</span><a href="block-list.html#556"><span class="typename" data-toggle="tooltip" data-title="bl.BlockList">BlockList</span></a><span class="punctuation">,</span> <span id="6357" data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span><span class="punctuation">:</span> <a href="html-weaver.html#2096"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#703"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">,</span>
        <span id="6384" data-toggle="tooltip" data-title="tr.VisualizerCall[]">visualizerCalls</span><span class="punctuation">:</span> <a href="html-weaver.html#2096"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1293"><span class="typename" data-toggle="tooltip" data-title="tr.VisualizerCall">VisualizerCall</span></a><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">{</span>
</code></pre>
<p>Clear source file level front matter and get the template reference.
This ensures that template and project level front matter is loaded.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2497"><span data-toggle="tooltip" data-title="tmp.FrontMatter">frontMatter</span></a> <span class="punctuation">=</span> <span class="keyword">null</span>
        <span class="keyword">let</span> <span id="6667" data-toggle="tooltip" data-title="tmp.Template">template</span> <span class="punctuation">=</span> <a href="html-weaver.html#2027"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#9842"><span class="member" data-toggle="tooltip" data-title="() =&gt; tmp.Template">getTemplate</span></a><span class="punctuation">(</span><span class="punctuation">)</span>
        <span class="keyword">let</span> <span id="6709" data-toggle="tooltip" data-title="string">contents</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#7664"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, blocks: bl.BlockList) =&gt; string">renderHtml</span></a><span class="punctuation">(</span><a href="html-weaver.html#6357"><span data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span></a><span class="punctuation">,</span> <a href="html-weaver.html#6336"><span data-toggle="tooltip" data-title="bl.BlockList">blocks</span></a><span class="punctuation">)</span>
        <span class="keyword">let</span> <span id="6769" data-toggle="tooltip" data-title="tmp.FrontMatter">fm</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2497"><span data-toggle="tooltip" data-title="tmp.FrontMatter">frontMatter</span></a> <span class="punctuation">||</span> <a href="html-weaver.html#2027"><span data-toggle="tooltip" data-title="typeof cfg">cfg</span></a><span class="punctuation">.</span><a href="config.html#7250"><span class="member" data-toggle="tooltip" data-title="() =&gt; cfg.Options">getOptions</span></a><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><a href="config.html#6036"><span data-toggle="tooltip" data-title="tmp.FrontMatter">frontMatter</span></a>
</code></pre>
<p>The translator fills in a list of render calls which is passed
with the current <code>codeFile</code> to the <code>generateScripts</code> function. This
function returns a script block that loads and calls the dynamic code.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">let</span> <span class="punctuation">[</span> <span id="7105" data-toggle="tooltip" data-title="string">scripts</span><span class="punctuation">,</span> <span id="7114" data-toggle="tooltip" data-title="string">styles</span> <span class="punctuation">]</span> <span class="punctuation">=</span> <a href="html-weaver.html#6769"><span data-toggle="tooltip" data-title="tmp.FrontMatter">fm</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="tmp.Visualizer[]">visualizers</span> <span class="punctuation">?</span>
            <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#10368"><span class="member" data-toggle="tooltip" data-title="(relPath: string, visualizers: tmp.Visualizer[], visualizerCalls: tr.VisualizerCall[]) =&gt; [string, string]">scriptsAndStyles</span></a><span class="punctuation">(</span><a href="html-weaver.html#6357"><span data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1075"><span data-toggle="tooltip" data-title="string">relTargetPath</span></a><span class="punctuation">,</span> <a href="html-weaver.html#6769"><span data-toggle="tooltip" data-title="tmp.FrontMatter">fm</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="tmp.Visualizer[]">visualizers</span><span class="punctuation">,</span> 
                <a href="html-weaver.html#6384"><span data-toggle="tooltip" data-title="tr.VisualizerCall[]">visualizerCalls</span></a><span class="punctuation">)</span> <span class="punctuation">:</span> 
            <span class="punctuation">[</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span> <span class="string">&quot;&quot;</span> <span class="punctuation">]</span>
</code></pre>
<p>Front matter, TOC, page contents, file path, and scripts are then
passed to the templating engine which constucts the outputted web page.</p>
<pre class="syntaxhighlight"><code>        <a href="html-weaver.html#6667"><span data-toggle="tooltip" data-title="tmp.Template">template</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(fm: tmp.FrontMatter, toc: tmp.Toc, contents: string, styles: string, scripts: string, relFilePath: string, fullFilePath: string) =&gt; void">generate</span><span class="punctuation">(</span><a href="html-weaver.html#6769"><span data-toggle="tooltip" data-title="tmp.FrontMatter">fm</span></a><span class="punctuation">,</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2711"><span data-toggle="tooltip" data-title="tmp.Toc">toc</span></a><span class="punctuation">,</span> <a href="html-weaver.html#6709"><span data-toggle="tooltip" data-title="string">contents</span></a><span class="punctuation">,</span> <a href="html-weaver.html#7114"><span data-toggle="tooltip" data-title="string">styles</span></a><span class="punctuation">,</span> <a href="html-weaver.html#7105"><span data-toggle="tooltip" data-title="string">scripts</span></a><span class="punctuation">,</span>
            <a href="html-weaver.html#6357"><span data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1075"><span data-toggle="tooltip" data-title="string">relTargetPath</span></a><span class="punctuation">,</span> <a href="html-weaver.html#6357"><span data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1047"><span data-toggle="tooltip" data-title="string">fullTargetPath</span></a><span class="punctuation">)</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#5559"><span class="member" data-toggle="tooltip" data-title="(relPath: string) =&gt; void">addTocEntry</span></a><span class="punctuation">(</span><a href="html-weaver.html#6357"><span data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1075"><span data-toggle="tooltip" data-title="string">relTargetPath</span></a><span class="punctuation">)</span>
    <span class="punctuation">}</span>
</code></pre>
<h3 id="rendering-html">Rendering HTML</h3>
<p>We use a custom markdown-it renderer to convert fenced TypeScript code
blocks to HTML.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">private</span> <span id="7664" class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, blocks: bl.BlockList) =&gt; string">renderHtml</span><span class="punctuation">(</span><span id="7848" data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span><span class="punctuation">:</span> <a href="html-weaver.html#2096"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#703"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">,</span> <span id="7874" data-toggle="tooltip" data-title="bl.BlockList">blocks</span><span class="punctuation">:</span> <a href="html-weaver.html#2060"><span data-toggle="tooltip" data-title="any">bl</span></a><span class="punctuation">.</span><a href="block-list.html#556"><span class="typename" data-toggle="tooltip" data-title="bl.BlockList">BlockList</span></a><span class="punctuation">)</span><span class="punctuation">:</span> <span class="keyword">string</span> <span class="punctuation">{</span>
</code></pre>
<p>We save the default fence renderer in order to restore it afterwards.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">let</span> <span id="8027" data-toggle="tooltip" data-title="Renderer.RenderRule">defaultFence</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer">renderer</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer.RenderRuleRecord">rules</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer.RenderRule">fence</span>
</code></pre>
<p>Now we define our custom renderer. It checks if a fenced code
block has a language designator. If it has, we call a subroutine
that converts the code to HTML and adds syntax hightlighting.
Othwerwise we call the default renderer.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer">renderer</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer.RenderRuleRecord">rules</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer.RenderRule">fence</span> <span class="punctuation">=</span> <span class="punctuation">(</span><span id="8425" data-toggle="tooltip" data-title="Token[]">tokens</span><span class="punctuation">,</span> <span id="8432" data-toggle="tooltip" data-title="number">index</span><span class="punctuation">,</span> <span id="8439" data-toggle="tooltip" data-title="MarkdownIt.Options">options</span><span class="punctuation">,</span> <span id="8448" data-toggle="tooltip" data-title="any">env</span><span class="punctuation">,</span> <span id="8453" data-toggle="tooltip" data-title="Renderer">self</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
            <span class="keyword">let</span> <span id="8481" data-toggle="tooltip" data-title="Token">token</span> <span class="punctuation">=</span> <a href="html-weaver.html#8425"><span data-toggle="tooltip" data-title="Token[]">tokens</span></a><span class="punctuation">[</span><a href="html-weaver.html#8432"><span data-toggle="tooltip" data-title="number">index</span></a><span class="punctuation">]</span>
            <span class="keyword">let</span> <span id="8520" data-toggle="tooltip" data-title="string[]">infos</span> <span class="punctuation">=</span> <a href="html-weaver.html#8481"><span data-toggle="tooltip" data-title="Token">token</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">info</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">trim</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">toLowerCase</span><span class="punctuation">(</span><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ (separator: string | RegExp, limit?: number): string[]; (splitter: { [Symbol.split](string: string, limit?: number): string[]; }, limit?: number): string[]; }">split</span><span class="punctuation">(</span><span class="string">/\s+/</span><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="html-weaver.html#8520"><span data-toggle="tooltip" data-title="string[]">infos</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">&gt;</span> <span class="number">0</span> <span class="punctuation">&amp;&amp;</span> <a href="html-weaver.html#8520"><span data-toggle="tooltip" data-title="string[]">infos</span></a><span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                <span class="keyword">try</span> <span class="punctuation">{</span>
                    <span class="keyword">return</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#9847"><span class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, code: string, language: string) =&gt; string">syntaxHighlightFencedCode</span></a><span class="punctuation">(</span><a href="html-weaver.html#7848"><span data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span></a><span class="punctuation">,</span>
                        <a href="html-weaver.html#8481"><span data-toggle="tooltip" data-title="Token">token</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">content</span><span class="punctuation">,</span> <a href="html-weaver.html#8520"><span data-toggle="tooltip" data-title="string[]">infos</span></a><span class="punctuation">[</span><span class="number">0</span><span class="punctuation">]</span><span class="punctuation">)</span>
                <span class="punctuation">}</span>
                <span class="keyword">catch</span> <span class="punctuation">(</span><span id="8810" data-toggle="tooltip" data-title="any">e</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                    <a href="html-weaver.html#2211"><span data-toggle="tooltip" data-title="typeof log">log</span></a><span class="punctuation">.</span><a href="logging.html#4443"><span class="member" data-toggle="tooltip" data-title="(output: string) =&gt; void">warn</span></a><span class="punctuation">(</span><span class="string">&quot;Syntax highlighting failed: &quot;</span> <span class="punctuation">+</span> <a href="html-weaver.html#8810"><span data-toggle="tooltip" data-title="any">e</span></a><span class="punctuation">.</span>message<span class="punctuation">)</span>
                <span class="punctuation">}</span>
            <span class="punctuation">}</span>
            <span class="keyword">return</span> <a href="html-weaver.html#8027"><span data-toggle="tooltip" data-title="Renderer.RenderRule">defaultFence</span></a><span class="punctuation">(</span><a href="html-weaver.html#8425"><span data-toggle="tooltip" data-title="Token[]">tokens</span></a><span class="punctuation">,</span> <a href="html-weaver.html#8432"><span data-toggle="tooltip" data-title="number">index</span></a><span class="punctuation">,</span> <a href="html-weaver.html#8439"><span data-toggle="tooltip" data-title="MarkdownIt.Options">options</span></a><span class="punctuation">,</span> <a href="html-weaver.html#8448"><span data-toggle="tooltip" data-title="any">env</span></a><span class="punctuation">,</span> <a href="html-weaver.html#8453"><span data-toggle="tooltip" data-title="Renderer">self</span></a><span class="punctuation">)</span>
        <span class="punctuation">}</span>
</code></pre>
<p>We will also customize table rendering so that wide tables will work
in small screens (add scrolling).</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer">renderer</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer.RenderRuleRecord">rules</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="Renderer.RenderRule">table_open</span> <span class="punctuation">=</span> 
            <span class="punctuation">(</span><span id="9217" data-toggle="tooltip" data-title="Token[]">tokens</span><span class="punctuation">,</span> <span id="9224" data-toggle="tooltip" data-title="number">index</span><span class="punctuation">,</span> <span id="9231" data-toggle="tooltip" data-title="MarkdownIt.Options">options</span><span class="punctuation">,</span> <span id="9240" data-toggle="tooltip" data-title="any">env</span><span class="punctuation">,</span> <span id="9245" data-toggle="tooltip" data-title="Renderer">self</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> 
                <span class="string">&#039;&lt;div style=&quot;overflow: auto&quot;&gt;\n&lt;table&gt;&#039;</span>
        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer">renderer</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer.RenderRuleRecord">rules</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="Renderer.RenderRule">table_close</span> <span class="punctuation">=</span>
            <span class="punctuation">(</span><span id="9375" data-toggle="tooltip" data-title="Token[]">tokens</span><span class="punctuation">,</span> <span id="9382" data-toggle="tooltip" data-title="number">index</span><span class="punctuation">,</span> <span id="9389" data-toggle="tooltip" data-title="MarkdownIt.Options">options</span><span class="punctuation">,</span> <span id="9398" data-toggle="tooltip" data-title="any">env</span><span class="punctuation">,</span> <span id="9403" data-toggle="tooltip" data-title="Renderer">self</span><span class="punctuation">)</span> <span class="punctuation">=&gt;</span> <span class="string">&#039;&lt;/table&gt;\n&lt;/div&gt;&#039;</span>
</code></pre>
<p>Before rendering the markdown we must concatenate the blocks together.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">let</span> <span id="9553" data-toggle="tooltip" data-title="string">markdown</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">...</span><a href="html-weaver.html#7874"><span data-toggle="tooltip" data-title="bl.BlockList">blocks</span></a><span class="punctuation">]</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="&lt;U&gt;(callbackfn: (value: bl.BlockList, index: number, array: bl.BlockList[]) =&gt; U, thisArg?: any) =&gt; U[]">map</span><span class="punctuation">(</span><span id="9581" data-toggle="tooltip" data-title="bl.BlockList">b</span> <span class="punctuation">=&gt;</span> <a href="html-weaver.html#9581"><span data-toggle="tooltip" data-title="bl.BlockList">b</span></a><span class="punctuation">.</span><a href="block-list.html#1107"><span data-toggle="tooltip" data-title="string">contents</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(separator?: string) =&gt; string">join</span><span class="punctuation">(</span><span class="string">&quot;&quot;</span><span class="punctuation">)</span>
        <span class="keyword">let</span> <span id="9619" data-toggle="tooltip" data-title="string">contents</span> <span class="punctuation">=</span> <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(src: string, env?: any) =&gt; string">render</span><span class="punctuation">(</span><a href="html-weaver.html#9553"><span data-toggle="tooltip" data-title="string">markdown</span></a><span class="punctuation">)</span>
</code></pre>
<p>Finally we restore the default renderer and return the result.</p>
<pre class="syntaxhighlight"><code>        <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2407"><span data-toggle="tooltip" data-title="MarkdownIt">mdit</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer">renderer</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer.RenderRuleRecord">rules</span><span class="punctuation">.</span><span data-toggle="tooltip" data-title="Renderer.RenderRule">fence</span> <span class="punctuation">=</span> <a href="html-weaver.html#8027"><span data-toggle="tooltip" data-title="Renderer.RenderRule">defaultFence</span></a>
        <span class="keyword">return</span> <a href="html-weaver.html#9619"><span data-toggle="tooltip" data-title="string">contents</span></a>
    <span class="punctuation">}</span>
</code></pre>
<p>We make use of <a href="https://highlightjs.readthedocs.io/en/latest/index.html">highlight.js</a> when converting the code snippet
defined in a fenced block to HTML. We map <code>jsonc</code> language to
<code>json</code> as highlight.js does not recognize it.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">private</span> <span id="9847" class="member" data-toggle="tooltip" data-title="(outputFile: tr.OutputFile, code: string, language: string) =&gt; string">syntaxHighlightFencedCode</span><span class="punctuation">(</span><span id="10103" data-toggle="tooltip" data-title="tr.OutputFile">outputFile</span><span class="punctuation">:</span> <a href="html-weaver.html#2096"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#703"><span class="typename" data-toggle="tooltip" data-title="tr.OutputFile">OutputFile</span></a><span class="punctuation">,</span> <span id="10129" data-toggle="tooltip" data-title="string">code</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">,</span>
        <span id="10143" data-toggle="tooltip" data-title="string">language</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">)</span> <span class="punctuation">{</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="html-weaver.html#10143"><span data-toggle="tooltip" data-title="string">language</span></a> <span class="punctuation">==</span> <span class="string">&quot;jsonc&quot;</span><span class="punctuation">)</span>
            <a href="html-weaver.html#10143"><span data-toggle="tooltip" data-title="string">language</span></a> <span class="punctuation">=</span> <span class="string">&quot;json&quot;</span>
        <span class="keyword">let</span> <span id="10250" data-toggle="tooltip" data-title="HighlightResult">res</span> <span class="punctuation">=</span> <a href="html-weaver.html#1977"><span data-toggle="tooltip" data-title="HLJSApi">hljs</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="(codeOrLanguageName: string, optionsOrCode: string | HighlightOptions, ignoreIllegals?: boolean) =&gt; HighlightResult">highlight</span><span class="punctuation">(</span><a href="html-weaver.html#10129"><span data-toggle="tooltip" data-title="string">code</span></a><span class="punctuation">,</span> <span class="punctuation">{</span> <span id="10279" data-toggle="tooltip" data-title="string">language</span> <span class="punctuation">}</span><span class="punctuation">)</span>
        <span class="keyword">return</span> <a href="html-weaver.html#2060"><span data-toggle="tooltip" data-title="typeof bl">bl</span></a><span class="punctuation">.</span><a href="block-list.html#456"><span data-toggle="tooltip" data-title="&quot;\n&lt;pre class=\&quot;syntaxhighlight\&quot;&gt;&lt;code&gt;&quot;">htmlHeader</span></a> <span class="punctuation">+</span> <a href="html-weaver.html#10250"><span data-toggle="tooltip" data-title="HighlightResult">res</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">value</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="() =&gt; string">trimRight</span><span class="punctuation">(</span><span class="punctuation">)</span> <span class="punctuation">+</span> <a href="html-weaver.html#2060"><span data-toggle="tooltip" data-title="typeof bl">bl</span></a><span class="punctuation">.</span><a href="block-list.html#523"><span data-toggle="tooltip" data-title="&quot;\n&lt;/code&gt;&lt;/pre&gt;\n&quot;">htmlFooter</span></a>
    <span class="punctuation">}</span>
</code></pre>
<h3 id="adding-dynamic-code">Adding Dynamic Code</h3>
<p>The helper function below builds a JavaScript block that loads the
current code file in the HTML and then calls the <code>window.runVisualizer</code>
method (that is dynamically initialized by the <a href="visualizer.html">visualizer</a>
module) for each visualizer instance found in the page. These can be
found in the <code>visualizerCalls</code> array populated by the translator.</p>
<p>The function also adds the current code file to the dictionary maintained
in this class. This dictionary is needed when the files are bundled.</p>
<pre class="syntaxhighlight"><code>    <span class="keyword">private</span> <span id="10368" class="member" data-toggle="tooltip" data-title="(relPath: string, visualizers: tmp.Visualizer[], visualizerCalls: tr.VisualizerCall[]) =&gt; [string, string]">scriptsAndStyles</span><span class="punctuation">(</span><span id="11022" data-toggle="tooltip" data-title="string">relPath</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">,</span> <span id="11038" data-toggle="tooltip" data-title="tmp.Visualizer[]">visualizers</span><span class="punctuation">:</span> <a href="html-weaver.html#1618"><span data-toggle="tooltip" data-title="any">tmp</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="tmp.Visualizer">Visualizer</span><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span>
        <span id="11069" data-toggle="tooltip" data-title="tr.VisualizerCall[]">visualizerCalls</span><span class="punctuation">:</span> <a href="html-weaver.html#2096"><span data-toggle="tooltip" data-title="any">tr</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1293"><span class="typename" data-toggle="tooltip" data-title="tr.VisualizerCall">VisualizerCall</span></a><span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="punctuation">:</span> <span class="punctuation">[</span> <span class="keyword">string</span><span class="punctuation">,</span> <span class="keyword">string</span> <span class="punctuation">]</span> <span class="punctuation">{</span>
        <span class="keyword">let</span> <span id="11151" data-toggle="tooltip" data-title="string[]">scripts</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
        <span class="keyword">let</span> <span id="11187" data-toggle="tooltip" data-title="string[]">styleSheets</span><span class="punctuation">:</span> <span class="keyword">string</span><span class="punctuation">[</span><span class="punctuation">]</span> <span class="punctuation">=</span> <span class="punctuation">[</span><span class="punctuation">]</span>
        <a href="html-weaver.html#11038"><span data-toggle="tooltip" data-title="tmp.Visualizer[]">visualizers</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(callbackfn: (value: tmp.Visualizer, index: number, array: tmp.Visualizer[]) =&gt; void, thisArg?: any) =&gt; void">forEach</span><span class="punctuation">(</span><span id="11244" data-toggle="tooltip" data-title="tmp.Visualizer">visualizer</span> <span class="punctuation">=&gt;</span> <span class="punctuation">{</span>
            <span class="keyword">let</span> <span id="11276" data-toggle="tooltip" data-title="string">name</span> <span class="punctuation">=</span> <a href="html-weaver.html#1521"><span data-toggle="tooltip" data-title="path.PlatformPath">path</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(path: string, suffix?: string) =&gt; string">basename</span><span class="punctuation">(</span><a href="html-weaver.html#11244"><span data-toggle="tooltip" data-title="tmp.Visualizer">visualizer</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">path</span><span class="punctuation">,</span> <span class="string">&#039;.ts&#039;</span><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><span class="punctuation">!</span><span class="typename" data-toggle="tooltip" data-title="ObjectConstructor">Object</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="{ &lt;T&gt;(o: { [s: string]: T; } | ArrayLike&lt;T&gt;): T[]; (o: {}): any[]; }">values</span><span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2797"><span data-toggle="tooltip" data-title="bnd.CodeFiles">codeFiles</span></a><span class="punctuation">)</span><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(searchElement: string, fromIndex?: number) =&gt; boolean">includes</span><span class="punctuation">(</span><a href="html-weaver.html#11244"><span data-toggle="tooltip" data-title="tmp.Visualizer">visualizer</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">path</span><span class="punctuation">)</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                <span class="keyword">if</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2797"><span data-toggle="tooltip" data-title="bnd.CodeFiles">codeFiles</span></a><span class="punctuation">[</span><a href="html-weaver.html#11276"><span data-toggle="tooltip" data-title="string">name</span></a><span class="punctuation">]</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                    <span class="keyword">let</span> <span id="11468" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <span class="number">1</span>
                    <span class="keyword">while</span> <span class="punctuation">(</span><span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2797"><span data-toggle="tooltip" data-title="bnd.CodeFiles">codeFiles</span></a><span class="punctuation">[</span><a href="html-weaver.html#11276"><span data-toggle="tooltip" data-title="string">name</span></a> <span class="punctuation">+</span> <a href="html-weaver.html#11468"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">]</span><span class="punctuation">)</span> <a href="html-weaver.html#11468"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">++</span>
                    <a href="html-weaver.html#11276"><span data-toggle="tooltip" data-title="string">name</span></a> <span class="punctuation">=</span> <a href="html-weaver.html#11276"><span data-toggle="tooltip" data-title="string">name</span></a> <span class="punctuation">+</span> <a href="html-weaver.html#11468"><span data-toggle="tooltip" data-title="number">i</span></a>
                <span class="punctuation">}</span>
                <span class="keyword">this</span><span class="punctuation">.</span><a href="html-weaver.html#2797"><span data-toggle="tooltip" data-title="bnd.CodeFiles">codeFiles</span></a><span class="punctuation">[</span><a href="html-weaver.html#11276"><span data-toggle="tooltip" data-title="string">name</span></a><span class="punctuation">]</span> <span class="punctuation">=</span> <a href="html-weaver.html#11244"><span data-toggle="tooltip" data-title="tmp.Visualizer">visualizer</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="string">path</span>
            <span class="punctuation">}</span>
            <span class="keyword">let</span> <span id="11676" data-toggle="tooltip" data-title="string">scriptFile</span> <span class="punctuation">=</span> <span class="string">&#039;js/&#039;</span> <span class="punctuation">+</span> <a href="html-weaver.html#11276"><span data-toggle="tooltip" data-title="string">name</span></a> <span class="punctuation">+</span> <span class="string">&#039;.js&#039;</span>
            <a href="html-weaver.html#11151"><span data-toggle="tooltip" data-title="string[]">scripts</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[]) =&gt; number">push</span><span class="punctuation">(</span>
                <span class="string">`&lt;script src=&quot;${</span><a href="html-weaver.html#1618"><span data-toggle="tooltip" data-title="typeof tmp">tmp</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(from: string, to: string) =&gt; string">relLink</span><span class="punctuation">(</span><a href="html-weaver.html#11022"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">,</span> <a href="html-weaver.html#11676"><span data-toggle="tooltip" data-title="string">scriptFile</span></a><span class="punctuation">)</span><span class="string">}&quot;&gt;&lt;/script&gt;`</span><span class="punctuation">)</span>
            <span class="keyword">if</span> <span class="punctuation">(</span><a href="html-weaver.html#11244"><span data-toggle="tooltip" data-title="tmp.Visualizer">visualizer</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="boolean">includeStyles</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                <span class="keyword">let</span> <span id="11883" data-toggle="tooltip" data-title="string">styleFile</span> <span class="punctuation">=</span> <span class="string">&#039;css/&#039;</span> <span class="punctuation">+</span> <a href="html-weaver.html#11276"><span data-toggle="tooltip" data-title="string">name</span></a> <span class="punctuation">+</span> <span class="string">&#039;.css&#039;</span>
                <a href="html-weaver.html#11187"><span data-toggle="tooltip" data-title="string[]">styleSheets</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[]) =&gt; number">push</span><span class="punctuation">(</span><span class="string">`&lt;link rel=&quot;stylesheet&quot; href=&quot;${</span>
                    <a href="html-weaver.html#1618"><span data-toggle="tooltip" data-title="typeof tmp">tmp</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(from: string, to: string) =&gt; string">relLink</span><span class="punctuation">(</span><a href="html-weaver.html#11022"><span data-toggle="tooltip" data-title="string">relPath</span></a><span class="punctuation">,</span> <a href="html-weaver.html#11883"><span data-toggle="tooltip" data-title="string">styleFile</span></a><span class="punctuation">)</span><span class="string">}&quot; /&gt;`</span><span class="punctuation">)</span>    
            <span class="punctuation">}</span>
        <span class="punctuation">}</span><span class="punctuation">)</span>
        <span class="keyword">if</span> <span class="punctuation">(</span><a href="html-weaver.html#11069"><span data-toggle="tooltip" data-title="tr.VisualizerCall[]">visualizerCalls</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span> <span class="punctuation">&gt;</span> <span class="number">0</span><span class="punctuation">)</span> <span class="punctuation">{</span>
            <a href="html-weaver.html#11151"><span data-toggle="tooltip" data-title="string[]">scripts</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[]) =&gt; number">push</span><span class="punctuation">(</span><span class="string">&#039;&lt;script&gt;&#039;</span><span class="punctuation">)</span>
            <span class="keyword">for</span> <span class="punctuation">(</span><span class="keyword">let</span> <span id="12179" data-toggle="tooltip" data-title="number">i</span> <span class="punctuation">=</span> <span class="number">0</span><span class="punctuation">;</span> <a href="html-weaver.html#12179"><span data-toggle="tooltip" data-title="number">i</span></a> <span class="punctuation">&lt;</span> <a href="html-weaver.html#11069"><span data-toggle="tooltip" data-title="tr.VisualizerCall[]">visualizerCalls</span></a><span class="punctuation">.</span><span data-toggle="tooltip" data-title="number">length</span><span class="punctuation">;</span> <a href="html-weaver.html#12179"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">++</span><span class="punctuation">)</span> <span class="punctuation">{</span>
                <span class="keyword">const</span> <span id="12244" data-toggle="tooltip" data-title="tr.VisualizerCall">rc</span> <span class="punctuation">=</span> <a href="html-weaver.html#11069"><span data-toggle="tooltip" data-title="tr.VisualizerCall[]">visualizerCalls</span></a><span class="punctuation">[</span><a href="html-weaver.html#12179"><span data-toggle="tooltip" data-title="number">i</span></a><span class="punctuation">]</span>
                <a href="html-weaver.html#11151"><span data-toggle="tooltip" data-title="string[]">scripts</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[]) =&gt; number">push</span><span class="punctuation">(</span><span class="string">`window.runVisualizer(&#039;${</span><a href="html-weaver.html#12244"><span data-toggle="tooltip" data-title="tr.VisualizerCall">rc</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1525"><span data-toggle="tooltip" data-title="string">visualizer</span></a><span class="string">}&#039;, &#039;${</span>
                    <a href="html-weaver.html#12244"><span data-toggle="tooltip" data-title="tr.VisualizerCall">rc</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1549"><span data-toggle="tooltip" data-title="string">params</span></a><span class="string">}&#039;, &#039;${</span><a href="html-weaver.html#12244"><span data-toggle="tooltip" data-title="tr.VisualizerCall">rc</span></a><span class="punctuation">.</span><a href="translators/base-translator.html#1569"><span data-toggle="tooltip" data-title="string">id</span></a><span class="string">}&#039;);`</span><span class="punctuation">)</span>
            <span class="punctuation">}</span>
            <a href="html-weaver.html#11151"><span data-toggle="tooltip" data-title="string[]">scripts</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(...items: string[]) =&gt; number">push</span><span class="punctuation">(</span><span class="string">&#039;&lt;/script&gt;&#039;</span><span class="punctuation">)</span>
        <span class="punctuation">}</span>
        <span class="keyword">return</span> <span class="punctuation">[</span><a href="html-weaver.html#11151"><span data-toggle="tooltip" data-title="string[]">scripts</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(separator?: string) =&gt; string">join</span><span class="punctuation">(</span><span class="string">&#039;\n&#039;</span><span class="punctuation">)</span><span class="punctuation">,</span> <a href="html-weaver.html#11187"><span data-toggle="tooltip" data-title="string[]">styleSheets</span></a><span class="punctuation">.</span><span class="member" data-toggle="tooltip" data-title="(separator?: string) =&gt; string">join</span><span class="punctuation">(</span><span class="string">&#039;\n&#039;</span><span class="punctuation">)</span><span class="punctuation">]</span>
    <span class="punctuation">}</span>
<span class="punctuation">}</span>
</code></pre>

        
    <div class="footer">
        Copyright © 2021 Tommi Johtela
        <div class="ad">
            Created with <a href="https://github.com/johtela/litscript">LiTScript</a>
        </div>
    </div>

    </div>
            <div class="stickypane">
                
    <div class="pagemenu">
        <h3>On This Page</h3>
            <ul class="pagetree">
                
            </ul>
    </div>
                
            </div>
        </div>
    </div>
    <script src="../js/main.js"></script>
    
</body>
</html>